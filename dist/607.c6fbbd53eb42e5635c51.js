(self.webpackChunkgotec_pos=self.webpackChunkgotec_pos||[]).push([[607],{48607:function(e,t,o){"use strict";o.r(t),o.d(t,{EmployeeModule:function(){return ie}});var n=o(61116),i=o(25548),l=o(42590),r=o(76675),s=o(64762),a=function(){return function(){this.documents=[]}}(),d=o(83361),u=o(42744),c=o(529),p=o(93820),m=o(93957),g=o(4244),h=o(66425),y=o(40068),f=o(36212),Z=o(47988),v=o(40920),A=o(6711),_=o(11462),x=o(57750),b=o(47671),q=o(63978),C=["modalContent"];function T(e,t){if(1&e&&p._UZ(0,"img",50),2&e){var o=p.oxw(2);p.Q6J("src",o.imageSrc||"assets/images/user.png",p.LSH)}}function M(e,t){if(1&e&&p._UZ(0,"img",50),2&e){var o=p.oxw(2);p.Q6J("src",o.apiURL+o.model.image,p.LSH)}}var w=function(e,t){return{"fa-plus":e,"fa-pencil":t}},J=function(e){return{"is-invalid":e}};function U(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",1),p.TgZ(1,"h5",2),p._UZ(2,"i",3),p._uU(3),p.ALo(4,"i18n"),p.qZA(),p.TgZ(5,"button",4),p.NdJ("click",function(){return t.$implicit.dismiss("Cross click")}),p.TgZ(6,"span",5),p._uU(7,"\xd7"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(8,"div",6),p.TgZ(9,"div"),p.YNc(10,T,1,1,"img",7),p.YNc(11,M,1,1,"img",7),p.TgZ(12,"input",8),p.NdJ("change",function(){return p.CHM(o),p.oxw().getBase64()}),p.qZA(),p.qZA(),p.TgZ(13,"button",9),p.NdJ("click",function(){return p.CHM(o),p.oxw().openPhotoDialog()}),p._UZ(14,"i",10),p._uU(15),p.ALo(16,"i18n"),p.qZA(),p.qZA(),p.TgZ(17,"form",11,12),p.NdJ("ngSubmit",function(){p.CHM(o);var e=p.MAs(18),t=p.oxw();return e.valid&&t.save(e)}),p.TgZ(19,"div",13),p.TgZ(20,"div",14),p.TgZ(21,"div",15),p.TgZ(22,"label",16),p.TgZ(23,"span"),p._uU(24,"*"),p.qZA(),p._uU(25),p.ALo(26,"i18n"),p.qZA(),p.TgZ(27,"input",17,18),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.name=e}),p.qZA(),p.TgZ(29,"div",19),p._uU(30),p.ALo(31,"i18n"),p.qZA(),p.qZA(),p.TgZ(32,"div",15),p.TgZ(33,"label",20),p.TgZ(34,"span"),p._uU(35,"*"),p.qZA(),p._uU(36),p.ALo(37,"i18n"),p.qZA(),p.TgZ(38,"input",21,22),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.phone=e}),p.qZA(),p.TgZ(40,"div",19),p._uU(41),p.ALo(42,"i18n"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(43,"div",14),p.TgZ(44,"div",15),p.TgZ(45,"label",23),p._uU(46),p.ALo(47,"i18n"),p.qZA(),p.TgZ(48,"input",24,25),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.email=e}),p.qZA(),p.qZA(),p.TgZ(50,"div",15),p.TgZ(51,"label",26),p._uU(52),p.ALo(53,"i18n"),p.qZA(),p.TgZ(54,"input",27,28),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.idNumber=e}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(56,"div",14),p.TgZ(57,"div",15),p.TgZ(58,"label",29),p._uU(59),p.ALo(60,"i18n"),p.qZA(),p.TgZ(61,"input",30,31),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.bankName=e}),p.qZA(),p.qZA(),p.TgZ(63,"div",15),p.TgZ(64,"label",32),p._uU(65),p.ALo(66,"i18n"),p.qZA(),p.TgZ(67,"input",33,34),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.bankAccountNumber=e}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(69,"div",14),p.TgZ(70,"div",15),p.TgZ(71,"label",35),p._uU(72),p.ALo(73,"i18n"),p.qZA(),p.TgZ(74,"input",36,37),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.city=e}),p.qZA(),p.qZA(),p.TgZ(76,"div",15),p.TgZ(77,"label",38),p._uU(78),p.ALo(79,"i18n"),p.qZA(),p.TgZ(80,"input",39,40),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.state=e}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(82,"div",41),p.TgZ(83,"label",38),p._uU(84),p.ALo(85,"i18n"),p.qZA(),p.TgZ(86,"input",42,43),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.salary=e}),p.qZA(),p.qZA(),p.TgZ(88,"div",41),p.TgZ(89,"label",44),p._uU(90),p.ALo(91,"i18n"),p.qZA(),p.TgZ(92,"textarea",45,46),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.address=e}),p._uU(94,"                "),p.qZA(),p.qZA(),p.qZA(),p.TgZ(95,"div",47),p.TgZ(96,"button",48),p.NdJ("click",function(){return t.$implicit.dismiss("Cross click")}),p._uU(97),p.ALo(98,"i18n"),p.qZA(),p.TgZ(99,"button",49),p._uU(100),p.ALo(101,"i18n"),p.qZA(),p.qZA(),p.qZA()}if(2&e){var n=p.MAs(18),i=p.MAs(28),l=p.MAs(39),r=p.oxw();p.xp6(2),p.Q6J("ngClass",p.WLB(63,w,!(null!=r.model&&r.model._id),null==r.model?null:r.model._id)),p.xp6(1),p.hij(" ",p.lcZ(4,31,"text_employee"),""),p.xp6(7),p.Q6J("ngIf",!r.model.image),p.xp6(1),p.Q6J("ngIf",r.model.image),p.xp6(4),p.hij(" ",p.lcZ(16,33,"text_browsePhoto")," "),p.xp6(10),p.hij(" ",p.lcZ(26,35,"text_name"),""),p.xp6(2),p.Q6J("ngModel",r.model.name)("ngClass",p.VKq(66,J,n.submitted&&i.invalid)),p.xp6(3),p.hij(" ",p.lcZ(31,37,"text_thisFieldIsRequired")," "),p.xp6(6),p.hij(" ",p.lcZ(37,39,"text_phone"),""),p.xp6(2),p.Q6J("ngModel",r.model.phone)("ngClass",p.VKq(68,J,n.submitted&&l.invalid)),p.xp6(3),p.hij(" ",p.lcZ(42,41,"text_thisFieldIsRequired")," "),p.xp6(5),p.hij(" ",p.lcZ(47,43,"text_email"),""),p.xp6(2),p.Q6J("ngModel",r.model.email),p.xp6(4),p.hij(" ",p.lcZ(53,45,"text_nationalIdentityCardNumber"),""),p.xp6(2),p.Q6J("ngModel",r.model.idNumber),p.xp6(5),p.hij(" ",p.lcZ(60,47,"text_bankName")," "),p.xp6(2),p.Q6J("ngModel",r.model.bankName),p.xp6(4),p.hij(" ",p.lcZ(66,49,"text_bankAcc#"),""),p.xp6(2),p.Q6J("ngModel",r.model.bankAccountNumber),p.xp6(5),p.hij(" ",p.lcZ(73,51,"text_city")," "),p.xp6(2),p.Q6J("ngModel",r.model.city),p.xp6(4),p.hij(" ",p.lcZ(79,53,"text_state"),""),p.xp6(2),p.Q6J("ngModel",r.model.state),p.xp6(4),p.hij(" ",p.lcZ(85,55,"text_salary"),""),p.xp6(2),p.Q6J("ngModel",r.model.salary),p.xp6(4),p.hij(" ",p.lcZ(91,57,"text_address"),""),p.xp6(2),p.Q6J("ngModel",r.model.address),p.xp6(5),p.Oqu(p.lcZ(98,59,"text_close")),p.xp6(3),p.Oqu(p.lcZ(101,61,"text_save"))}}var P=JSON.parse(localStorage.getItem("lang")),N=function(){function e(e,t,o,n,i,l){var r=this;this.formBuilder=e,this.modalService=t,this.commonService=o,this.apiService=n,this.urlHandler=i,this.utilCtrl=l,this.model=new a,this.onPopupClose=new p.vpe,this.apiURL=c.N.apiUrl,this.files=[],this.toBase64=function(e){return new Promise(function(t,o){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){r.imageSrc=n.result,r.model.image=null,t(n.result)},n.onerror=function(e){return o(e)}})}}return e.prototype.ngOnChanges=function(){var e=this;this.showPopup&&this.modalService.open(this.modalContent,{ariaLabelledBy:"modal-basic-title"}).result.then(function(e){console.log("Closed with")},function(t){e.onPopupClose.emit(t),console.log(t)})},e.prototype.onBrowse=function(e){var t=this;e.files.forEach(function(e){t.files.push(e)})},e.prototype.onFileRemove=function(e){this.model.documents=e.documents,this.files=e.files},e.prototype.ngOnInit=function(){},e.prototype.save=function(e){return(0,s.mG)(this,void 0,void 0,function(){var t,o,n=this;return(0,s.Jh)(this,function(i){switch(i.label){case 0:return t=null,this.model.employeeId=this.model._id,t=this.model._id?this.urlHandler.url.employee.update:this.urlHandler.url.employee.create,this.model.hasImage=!!this.imageSrc,this.model.image=this.imageSrc,this.files.length?[4,this.apiService.uploadFile("uploadFiles","file",this.files)]:[3,2];case 1:if(!(o=i.sent()).success)return[2,this.utilCtrl.showToast(o.message,this.utilCtrl.toastTypeArr.DANGER)];o.body&&o.body.length&&(o.body.forEach(function(e){var t=n.model.documents.find(function(t){return t.name==e.name});e.title=t.title}),this.model.documents.forEach(function(e,t){e.local&&n.model.documents.splice(t,1)}),o.body.forEach(function(e){n.model.documents.push(e)})),i.label=2;case 2:return this.apiService.post(t,this.model).then(function(t){t.success?(e.resetForm(),n.utilCtrl.showToast(P[t.message],n.utilCtrl.toastTypeArr.SUCCESS),n.modalService.dismissAll()):n.utilCtrl.showToast(P[t.message],n.utilCtrl.toastTypeArr.DANGER)},function(e){return console.log(e)}),[2]}})})},e.prototype.getBase64=function(){return(0,s.mG)(this,void 0,void 0,function(){var e,t;return(0,s.Jh)(this,function(o){switch(o.label){case 0:return e=document.querySelector("#photoUpload").files[0],t=this,[4,this.toBase64(e)];case 1:return t.base64=o.sent(),[2]}})})},e.prototype.openPhotoDialog=function(){document.getElementById("photoUpload").click()},e.\u0275fac=function(t){return new(t||e)(p.Y36(_.qu),p.Y36(x.FF),p.Y36(b.v_),p.Y36(m.s),p.Y36(h.z),p.Y36(y.b))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-add-employee"]],viewQuery:function(e,t){var o;1&e&&p.Gf(C,7),2&e&&p.iGM(o=p.CRH())&&(t.modalContent=o.first)},inputs:{showPopup:"showPopup",model:"model"},outputs:{onPopupClose:"onPopupClose"},features:[p.TTD],decls:2,vars:0,consts:[["modalContent",""],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","f-w-600"],[1,"fa",3,"ngClass"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"form-group","text-center"],["alt","","class","img-fluid img-90 rounded-circle blur-up lazyloaded",3,"src",4,"ngIf"],["hidden","","id","photoUpload","type","file",3,"change"],[1,"btn","btn-primary","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-picture-o"],["novalidate","",1,"needs-validation","user-add",3,"ngSubmit"],["f","ngForm"],[1,"modal-body"],[1,"form-row"],[1,"form-group","col-md-6"],["for","name"],["id","name","name","name","type","text","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["name","ngModel"],[1,"invalid-feedback"],["for","phone"],["name","phone","type","text","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["phone","ngModel"],["for","email"],["name","email","type","email","id","email",1,"form-control",3,"ngModel","ngModelChange"],["email","ngModel"],["for","idNumber"],["id","idNumber","name","idNumber","type","text",1,"form-control",3,"ngModel","ngModelChange"],["idNumber","ngModel"],["for","bankName"],["name","bankName","type","text","id","bankName",1,"form-control",3,"ngModel","ngModelChange"],["bankName","ngModel"],["for","bankAccountNumber"],["name","bankAccountNumber","type","text","id","bankAccountNumber",1,"form-control",3,"ngModel","ngModelChange"],["bankAccountNumber","ngModel"],["for","city"],["name","city","type","text","id","city",1,"form-control",3,"ngModel","ngModelChange"],["city","ngModel"],["for","state"],["name","state","type","text","id","state",1,"form-control",3,"ngModel","ngModelChange"],["state","ngModel"],[1,"form-group"],["name","salary","type","text","id","salary",1,"form-control",3,"ngModel","ngModelChange"],["salary","ngModel"],["for","address"],["name","address","type","text",1,"form-control",3,"ngModel","ngModelChange"],["address","ngModel"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary"],["alt","",1,"img-fluid","img-90","rounded-circle","blur-up","lazyloaded",3,"src"]],template:function(e,t){1&e&&p.YNc(0,U,102,70,"ng-template",null,0,p.W1O)},directives:[n.mk,n.O5,_._Y,_.JL,_.F,_.Fj,_.Q7,_.JJ,_.On],pipes:[q.X],styles:[""]}),e}(),L=JSON.parse(localStorage.getItem("lang")),S=function(){function e(e,t,o,n,i,l){var r=this;this.apiService=e,this.events=t,this.urlHandler=o,this.utilCtrl=n,this.socket=i,this.authGuard=l,this.apiURL=c.N.apiUrl,this.settings={actions:{position:"right",add:!1},mode:"external",add:{confirmCreate:!0},delete:{confirmDelete:!1},edit:{confirmSave:!0},columns:{name:{title:L.text_name,type:"html",valuePrepareFunction:function(e,t){return t.image?'<div><img src="'+(r.apiURL+t.image)+'" />'+e+"</div>":'<div><img src="assets/images/user.png" />'+e+"</div>"}},idNumber:{title:L["text_nationalId#"],type:"html"},email:{title:L.text_email},phone:{title:L.text_phone},salary:{title:L.text_salary,valuePrepareFunction:function(e,t){return r.user.company.country.currency.symbol+" "+e}},documents:{title:L.text_documents,type:"custom",valuePrepareFunction:function(e,t){return e},renderComponent:u.K,onComponentInitFunction:function(e){e.save.subscribe(function(e){console.log(e)})}}}},this.employee=[],this.user=new d.n,this.selectedEmployee=new a,this.user=this.authGuard.getLoggedInUser(),this.socketEvents()}return e.prototype.socketEvents=function(){var e=this;this.socket.on("employee_created",function(t){e.employee.unshift(t),e.employee=(0,s.ev)([],(0,s.CR)(e.employee))}),this.socket.on("employee_updated",function(t){var o=e.employee.findIndex(function(e){return e._id==t._id});e.employee[o]=t,e.employee=(0,s.ev)([],(0,s.CR)(e.employee))}),this.socket.on("employee_deleted",function(t){var o=e.employee.findIndex(function(e){return e._id==t._id});e.employee.splice(o,1),e.employee=(0,s.ev)([],(0,s.CR)(e.employee))})},e.prototype.ngOnInit=function(){this.getEmployee()},e.prototype.getEmployee=function(){return(0,s.mG)(this,void 0,void 0,function(){var e;return(0,s.Jh)(this,function(t){switch(t.label){case 0:return[4,this.apiService.get(this.urlHandler.url.employee.get_employee)];case 1:return(e=t.sent()).success&&(this.employee=e.body),[2]}})})},e.prototype.edit=function(e){this.showPopup=!0,this.selectedEmployee=e.data},e.prototype.delete=function(e){this.showDeletePopup=!0,this.deleteURL=this.urlHandler.url.employee.delete+e.data._id},e.prototype.onAddPopupClose=function(e){this.showPopup=!1,this.selectedEmployee=new a},e.\u0275fac=function(t){return new(t||e)(p.Y36(m.s),p.Y36(g.n),p.Y36(h.z),p.Y36(y.b),p.Y36(f.sk),p.Y36(Z.a))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-employee-list"]],decls:16,vars:12,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header"],["type","button","data-toggle","modal","data-original-title","test","data-target","#exampleModal",1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus"],[1,"card-body","vendor-table"],["id","batchDelete",1,"custom-datatable","vendor-list"],[1,"table-responsive"],[3,"settings","source","edit","delete"],[3,"deleteURL","showPopup","onPopupClose"],[3,"model","showPopup","onPopupClose"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"h5"),p._uU(4),p.ALo(5,"i18n"),p.TgZ(6,"button",3),p.NdJ("click",function(){return t.showPopup=!0}),p._UZ(7,"i",4),p._uU(8),p.ALo(9,"i18n"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"div",5),p.TgZ(11,"div",6),p.TgZ(12,"div",7),p.TgZ(13,"ng2-smart-table",8),p.NdJ("edit",function(e){return t.edit(e)})("delete",function(e){return t.delete(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(14,"app-delete-record",9),p.NdJ("onPopupClose",function(){return t.showDeletePopup=!1}),p.qZA(),p.TgZ(15,"app-add-employee",10),p.NdJ("onPopupClose",function(e){return t.onAddPopupClose(e)}),p.qZA()),2&e&&(p.xp6(4),p.hij("",p.lcZ(5,8,"text_details")," "),p.xp6(4),p.hij(" ",p.lcZ(9,10,"text_add"),""),p.xp6(5),p.Q6J("settings",t.settings)("source",t.employee),p.xp6(1),p.Q6J("deleteURL",t.deleteURL)("showPopup",t.showDeletePopup),p.xp6(1),p.Q6J("model",t.selectedEmployee)("showPopup",t.showPopup))},directives:[v.T5,A.c,N],pipes:[q.X],styles:[""]}),e}(),k=function(){return function(){this.year=(new Date).getFullYear(),this.month=(new Date).getMonth()+1,this.documents=[]}}(),F=o(82589),Y=o(99624),R=o(1509),Q=["modalContent"];function E(e,t){if(1&e&&(p.TgZ(0,"option",33),p._uU(1),p.qZA()),2&e){var o=t.$implicit;p.Q6J("value",o._id),p.xp6(1),p.Oqu(o.name)}}function H(e,t){if(1&e&&(p.TgZ(0,"option",33),p._uU(1),p.qZA()),2&e){var o=t.$implicit;p.Q6J("value",o),p.xp6(1),p.Oqu(o)}}function I(e,t){if(1&e&&(p.TgZ(0,"option",33),p._uU(1),p.qZA()),2&e){var o=t.$implicit;p.Q6J("value",o.value),p.xp6(1),p.Oqu(o.text)}}var O=function(e,t){return{"fa-plus":e,"fa-pencil":t}},D=function(e){return{"is-invalid":e}};function j(e,t){if(1&e){var o=p.EpF();p.TgZ(0,"div",1),p.TgZ(1,"h5",2),p._UZ(2,"i",3),p._uU(3),p.ALo(4,"i18n"),p.qZA(),p.TgZ(5,"button",4),p.NdJ("click",function(){return t.$implicit.dismiss("Cross click")}),p.TgZ(6,"span",5),p._uU(7,"\xd7"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(8,"form",6,7),p.NdJ("ngSubmit",function(){p.CHM(o);var e=p.MAs(9),t=p.oxw();return e.valid&&t.save(e)}),p.TgZ(10,"div",8),p.TgZ(11,"div",9),p.TgZ(12,"div",10),p.TgZ(13,"label",11),p.TgZ(14,"span"),p._uU(15,"*"),p.qZA(),p._uU(16),p.ALo(17,"i18n"),p.qZA(),p.TgZ(18,"select",12,13),p.NdJ("change",function(){return p.CHM(o),p.oxw().setSalary()})("ngModelChange",function(e){return p.CHM(o),p.oxw().model.employee=e}),p.YNc(20,E,2,2,"option",14),p.qZA(),p.TgZ(21,"div",15),p._uU(22),p.ALo(23,"i18n"),p.qZA(),p.qZA(),p.TgZ(24,"div",10),p.TgZ(25,"label",16),p.TgZ(26,"span"),p._uU(27,"*"),p.qZA(),p._uU(28),p.ALo(29,"i18n"),p.qZA(),p.TgZ(30,"input",17,18),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.amountPaid=e}),p.qZA(),p.TgZ(32,"div",15),p._uU(33),p.ALo(34,"i18n"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(35,"div",9),p.TgZ(36,"div",10),p.TgZ(37,"label",19),p._uU(38),p.ALo(39,"i18n"),p.qZA(),p.TgZ(40,"select",20,21),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.year=e}),p.YNc(42,H,2,2,"option",14),p.qZA(),p.qZA(),p.TgZ(43,"div",10),p.TgZ(44,"label",22),p._uU(45),p.ALo(46,"i18n"),p.qZA(),p.TgZ(47,"select",23,24),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.month=e}),p.YNc(49,I,2,2,"option",14),p.qZA(),p.qZA(),p.qZA(),p.TgZ(50,"div",25),p.TgZ(51,"label",26),p._uU(52),p.ALo(53,"i18n"),p.qZA(),p.TgZ(54,"textarea",27,28),p.NdJ("ngModelChange",function(e){return p.CHM(o),p.oxw().model.description=e}),p.qZA(),p.qZA(),p.TgZ(56,"app-documents-preview",29),p.NdJ("onFileRemove",function(e){return p.CHM(o),p.oxw().onFileRemove(e)})("onBrowse",function(e){return p.CHM(o),p.oxw().onBrowse(e)}),p.qZA(),p.qZA(),p.TgZ(57,"div",30),p.TgZ(58,"button",31),p.NdJ("click",function(){return t.$implicit.dismiss("Cross click")}),p._uU(59),p.ALo(60,"i18n"),p.qZA(),p.TgZ(61,"button",32),p._uU(62),p.ALo(63,"i18n"),p.qZA(),p.qZA(),p.qZA()}if(2&e){var n=p.MAs(9),i=p.MAs(19),l=p.MAs(31),r=p.MAs(41),s=p.MAs(48),a=p.oxw();p.xp6(2),p.Q6J("ngClass",p.WLB(45,O,!(null!=a.model&&a.model._id),null==a.model?null:a.model._id)),p.xp6(1),p.hij(" ",p.lcZ(4,25,"text_salary"),""),p.xp6(13),p.hij(" ",p.lcZ(17,27,"text_employees"),""),p.xp6(2),p.Q6J("ngModel",a.model.employee)("ngClass",p.VKq(48,D,n.submitted&&i.invalid)),p.xp6(2),p.Q6J("ngForOf",a.employeeList),p.xp6(2),p.hij(" ",p.lcZ(23,29,"text_thisFieldIsRequired")," "),p.xp6(6),p.hij(" ",p.lcZ(29,31,"text_salary"),""),p.xp6(2),p.Q6J("ngModel",a.model.amountPaid)("ngClass",p.VKq(50,D,n.submitted&&l.invalid)),p.xp6(3),p.hij(" ",p.lcZ(34,33,"text_thisFieldIsRequired")," "),p.xp6(5),p.hij(" ",p.lcZ(39,35,"text_years"),""),p.xp6(2),p.Q6J("ngModel",a.model.year)("ngClass",p.VKq(52,D,n.submitted&&r.invalid)),p.xp6(2),p.Q6J("ngForOf",a.years),p.xp6(3),p.hij(" ",p.lcZ(46,37,"text_months"),""),p.xp6(2),p.Q6J("ngModel",a.model.month)("ngClass",p.VKq(54,D,n.submitted&&s.invalid)),p.xp6(2),p.Q6J("ngForOf",a.months),p.xp6(3),p.hij(" ",p.lcZ(53,39,"text_description"),""),p.xp6(2),p.Q6J("ngModel",a.model.description),p.xp6(2),p.Q6J("documents",a.model.documents)("files",a.files),p.xp6(3),p.Oqu(p.lcZ(60,41,"text_close")),p.xp6(3),p.Oqu(p.lcZ(63,43,"text_save"))}}var G=JSON.parse(localStorage.getItem("lang")),B=function(){function e(e,t,o,n,i,l,r,s){this.formBuilder=e,this.modalService=t,this.commonService=o,this.apiService=n,this.urlHandler=i,this.utilCtrl=l,this.ngxSpinnerService=r,this._sanitizer=s,this.model=new k,this.onPopupClose=new p.vpe,this.apiURL=c.N.apiUrl,this.years=[],this.months=[],this.files=[],this.employeeList=[]}return e.prototype.ngOnChanges=function(){var e=this;this.files=[],this.showPopup&&this.modalService.open(this.modalContent,{ariaLabelledBy:"modal-basic-title"}).result.then(function(e){console.log("Closed with")},function(t){e.onPopupClose.emit(t),console.log(t)})},e.prototype.getEmployees=function(){return(0,s.mG)(this,void 0,void 0,function(){var e;return(0,s.Jh)(this,function(t){switch(t.label){case 0:return[4,this.apiService.get(this.urlHandler.url.employee.get_employee)];case 1:return(e=t.sent()).success&&(this.employeeList=e.body),[2]}})})},e.prototype.setSalary=function(){var e=this,t=this.employeeList.find(function(t){return t._id==e.model.employee});t&&(this.model.amountPaid=t.salary)},e.prototype.ngOnInit=function(){this.getEmployees(),this.years=this.commonService.getYears(),this.months=this.commonService.getMonthList()},e.prototype.save=function(e){return(0,s.mG)(this,void 0,void 0,function(){var t,o,n=this;return(0,s.Jh)(this,function(i){switch(i.label){case 0:return t=null,this.model.salaryId=this.model._id,t=this.model._id?this.urlHandler.url.employee_salary.update:this.urlHandler.url.employee_salary.pay,this.files.length?[4,this.apiService.uploadFile("uploadFiles","file",this.files)]:[3,2];case 1:if(!(o=i.sent()).success)return[2,this.utilCtrl.showToast(o.message,this.utilCtrl.toastTypeArr.DANGER)];o.body&&o.body.length&&(o.body.forEach(function(e){var t=n.model.documents.find(function(t){return t.name==e.name});e.title=t.title}),this.model.documents.forEach(function(e,t){e.local&&n.model.documents.splice(t,1)}),o.body.forEach(function(e){n.model.documents.push(e)})),i.label=2;case 2:return this.apiService.post(t,this.model).then(function(t){t.success?(e.resetForm(),n.utilCtrl.showToast(G[t.message],n.utilCtrl.toastTypeArr.SUCCESS),n.modalService.dismissAll()):n.utilCtrl.showToast(G[t.message],n.utilCtrl.toastTypeArr.DANGER)},function(e){return console.log(e)}),[2]}})})},e.prototype.onBrowse=function(e){var t=this;e.files.forEach(function(e){t.files.push(e)})},e.prototype.onFileRemove=function(e){this.model.documents=e.documents,this.files=e.files},e.\u0275fac=function(t){return new(t||e)(p.Y36(_.qu),p.Y36(x.FF),p.Y36(b.v_),p.Y36(m.s),p.Y36(h.z),p.Y36(y.b),p.Y36(F.t2),p.Y36(Y.H7))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-pay-salary"]],viewQuery:function(e,t){var o;1&e&&p.Gf(Q,7),2&e&&p.iGM(o=p.CRH())&&(t.modalContent=o.first)},inputs:{showPopup:"showPopup",model:"model"},outputs:{onPopupClose:"onPopupClose"},features:[p.TTD],decls:2,vars:0,consts:[["modalContent",""],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","f-w-600"],[1,"fa",3,"ngClass"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["novalidate","",1,"needs-validation","user-add",3,"ngSubmit"],["f","ngForm"],[1,"modal-body"],[1,"form-row"],[1,"form-group","col-md-6"],["for","employee"],["id","name","name","employee","required","",1,"form-control",3,"ngModel","ngClass","change","ngModelChange"],["employee","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"invalid-feedback"],["for","amountPaid"],["name","amountPaid","type","text","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["amountPaid","ngModel"],["for","year"],["id","year","name","year","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["year","ngModel"],["for","refNo"],["id","month","name","month","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["month","ngModel"],[1,"form-group"],["for","description"],["id","description","name","description","type","text",1,"form-control",3,"ngModel","ngModelChange"],["description","ngModel"],[3,"documents","files","onFileRemove","onBrowse"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary"],[3,"value"]],template:function(e,t){1&e&&p.YNc(0,j,64,56,"ng-template",null,0,p.W1O)},directives:[n.mk,_._Y,_.JL,_.F,_.EJ,_.Q7,_.JJ,_.On,n.sg,_.Fj,R.Z,_.YN,_.Kr],pipes:[q.X],styles:[""]}),e}(),z=JSON.parse(localStorage.getItem("lang")),X=function(){function e(e,t,o,n,i,l,r,s,a){var p=this;this.apiService=e,this.events=t,this.urlHandler=o,this.utilCtrl=n,this.socket=i,this.datePipe=l,this.commonService=r,this.activatedRoute=s,this.authGuard=a,this.apiURL=c.N.apiUrl,this.settings={actions:{position:"right",add:!1,edit:!0},mode:"external",add:{confirmCreate:!0},delete:{confirmDelete:!1},edit:{confirmSave:!0},columns:{employee_doc:{title:z.text_employee,type:"html",valuePrepareFunction:function(e,t){return t.employee_doc.image?'<div><img src="'+(p.apiURL+t.employee_doc.image)+'" />'+t.employee_doc.name+"</div>":'<div><img src="assets/images/user.png" />'+t.employee_doc.name+"</div>"}},salaryDate:{title:z.text_date,type:"string",valuePrepareFunction:function(e,t){if(console.log(e),e)return p.datePipe.transform(e,"MMM y")}},amountPaid:{title:z.text_amountPaid,type:"string",valuePrepareFunction:function(e,t){return p.user.company.country.currency.symbol+" "+e}},agreedSalary:{title:z.text_salary,valuePrepareFunction:function(e,t){return p.user.company.country.currency.symbol+" "+t.employee_doc.salary}},remainingSalary:{title:z.text_remaining,valuePrepareFunction:function(e,t){var o=t.employee_doc.salary-t.amountPaid;return o<0?"("+p.user.company.country.currency.symbol+" "+-1*o+" paid extra)":p.user.company.country.currency.symbol+" "+o}},documents:{title:z.text_documents,type:"custom",valuePrepareFunction:function(e,t){return e},renderComponent:u.K,onComponentInitFunction:function(e){e.save.subscribe(function(e){console.log(e)})}}}},this.records=[],this.employeeList=[],this.years=[],this.months=[],this.user=new d.n,this.selectedRecord=new k,this.user=this.authGuard.getLoggedInUser(),this.employeeId=this.activatedRoute.snapshot.params.employeeId,this.employeeName=this.activatedRoute.snapshot.params.name,this.socketEvents()}return e.prototype.socketEvents=function(){var e=this;this.socket.on("employee_salary_created",function(t){var o=t;o.employee_doc=t.employee,o.employee=t.employee._id,e.records.unshift(o),e.records=(0,s.ev)([],(0,s.CR)(e.records))}),this.socket.on("employee_salary_updated",function(t){var o=e.records.findIndex(function(e){return e._id==t._id});e.records[o]=t,e.records[o].employee_doc=t.employee,e.records[o].employee=t.employee._id,e.records=(0,s.ev)([],(0,s.CR)(e.records))}),this.socket.on("employee_salary_deleted",function(t){var o=e.records.findIndex(function(e){return e._id==t._id});e.records.splice(o,1),e.records=(0,s.ev)([],(0,s.CR)(e.records))})},e.prototype.ngOnInit=function(){this.years=this.commonService.getYears(),this.months=this.commonService.getMonthList(),this.getData()},e.prototype.getData=function(){return(0,s.mG)(this,void 0,void 0,function(){var e;return(0,s.Jh)(this,function(t){switch(t.label){case 0:return[4,this.apiService.get(this.urlHandler.url.employee_salary.get_salary_by_employee_id+this.employeeId)];case 1:return(e=t.sent()).success&&(this.records=e.body),[2]}})})},e.prototype.delete=function(e){this.showDeletePopup=!0,this.deleteURL=this.urlHandler.url.employee_salary.delete+e.data._id},e.prototype.edit=function(e){this.showPopup=!0,this.selectedRecord=e.data},e.prototype.onAddPopupClose=function(e){this.selectedRecord=new k,this.showPopup=!1},e.\u0275fac=function(t){return new(t||e)(p.Y36(m.s),p.Y36(g.n),p.Y36(h.z),p.Y36(y.b),p.Y36(f.sk),p.Y36(n.uU),p.Y36(b.v_),p.Y36(i.gz),p.Y36(Z.a))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-salary-report-detail"]],decls:12,vars:10,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header","p-0"],[1,"p-3"],[1,"card-body","vendor-table"],["id","batchDelete",1,"custom-datatable","vendor-list"],[1,"table-responsive"],[3,"settings","source","edit","delete"],[3,"deleteURL","showPopup","onPopupClose"],[3,"model","showPopup","onPopupClose"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"h5",3),p._uU(4),p.ALo(5,"i18n"),p.qZA(),p.qZA(),p.TgZ(6,"div",4),p.TgZ(7,"div",5),p.TgZ(8,"div",6),p.TgZ(9,"ng2-smart-table",7),p.NdJ("edit",function(e){return t.edit(e)})("delete",function(e){return t.delete(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"app-delete-record",8),p.NdJ("onPopupClose",function(){return t.showDeletePopup=!1}),p.qZA(),p.TgZ(11,"app-pay-salary",9),p.NdJ("onPopupClose",function(e){return t.onAddPopupClose(e)}),p.qZA()),2&e&&(p.xp6(4),p.AsE("",p.lcZ(5,8,"text_details")," :",t.employeeName,""),p.xp6(5),p.Q6J("settings",t.settings)("source",t.records),p.xp6(1),p.Q6J("deleteURL",t.deleteURL)("showPopup",t.showDeletePopup),p.xp6(1),p.Q6J("model",t.selectedRecord)("showPopup",t.showPopup))},directives:[v.T5,A.c,B],pipes:[q.X],styles:[""]}),e}(),K=o(49469);function $(e,t){if(1&e&&(p.TgZ(0,"option",8),p._uU(1),p.qZA()),2&e){var o=t.$implicit;p.Q6J("value",o._id),p.xp6(1),p.Oqu(o.name)}}function V(e,t){if(1&e&&(p.TgZ(0,"option",8),p._uU(1),p.qZA()),2&e){var o=t.$implicit;p.Q6J("value",o),p.xp6(1),p.Oqu(o)}}function W(e,t){if(1&e&&(p.TgZ(0,"option",8),p._uU(1),p.qZA()),2&e){var o=t.$implicit;p.Q6J("value",o.value),p.xp6(1),p.Oqu(o.text)}}var ee=JSON.parse(localStorage.getItem("lang")),te=[{canActivate:[l.e],path:"employee-list",component:S,data:{title:"text_employeeList",breadcrumb:"text_employeeList",id:r.AN.EmployeeList}},{canActivate:[l.e],path:"salary-report",component:function(){function e(e,t,o,n,i,l,r,s){var a=this;this.apiService=e,this.events=t,this.urlHandler=o,this.utilCtrl=n,this.socket=i,this.datePipe=l,this.commonService=r,this.authGuard=s,this.apiURL=c.N.apiUrl,this.settings={actions:{position:"right",delete:!1,add:!1,edit:!1},mode:"external",add:{confirmCreate:!0},delete:{confirmDelete:!1},edit:{confirmSave:!0},columns:{employee_doc:{title:ee.text_employee,type:"html",valuePrepareFunction:function(e,t){return t.employee_doc.image?'<div><img src="'+(a.apiURL+t.employee_doc.image)+'" />'+t.employee_doc.name+"</div>":'<div><img src="assets/images/user.png" />'+t.employee_doc.name+"</div>"}},salaryDate:{title:ee.text_date,type:"string",valuePrepareFunction:function(e,t){if(console.log(e),e)return a.datePipe.transform(e,"MMM y")}},amountPaid:{title:ee.text_amountPaid,type:"string",valuePrepareFunction:function(e,t){return a.user.company.country.currency.symbol+" "+e}},agreedSalary:{title:ee.text_salary,valuePrepareFunction:function(e,t){return a.user.company.country.currency.symbol+" "+t.employee_doc.salary}},remainingSalary:{title:ee.text_remaining,valuePrepareFunction:function(e,t){var o=t.employee_doc.salary-t.amountPaid;return o<0?"("+a.user.company.country.currency.symbol+" "+-1*o+" paid extra)":a.user.company.country.currency.symbol+" "+o}},button:{title:ee.text_details,type:"custom",valuePrepareFunction:function(e,t){return"/employee/salary-detail/"+t.employee+"/"+t.employee_doc.name},renderComponent:K.f,onComponentInitFunction:function(e){e.save.subscribe(function(e){console.log(e)})}}}},this.records=[],this.employeeList=[],this.years=[],this.months=[],this.model={selectedEmployee:-1,year:-1,month:-1},this.user=new d.n,this.user=this.authGuard.getLoggedInUser(),this.socketEvents()}return e.prototype.ngOnDestroy=function(){this.socket.removeListener("employee_salary_created"),this.socket.removeListener("employee_salary_updated"),this.socket.removeListener("employee_salary_deleted")},e.prototype.socketEvents=function(){var e=this;this.socket.on("employee_salary_created",function(t){var o=t;o.employee_doc=t.employee,o.employee=t.employee._id,e.records.unshift(o),e.records=(0,s.ev)([],(0,s.CR)(e.records))}),this.socket.on("employee_salary_updated",function(t){var o=e.records.findIndex(function(e){return e._id==t._id});e.records[o]=t,e.records[o].employee_doc=t.employee,e.records[o].employee=t.employee._id,e.records=(0,s.ev)([],(0,s.CR)(e.records))}),this.socket.on("employee_salary_deleted",function(t){var o=e.records.findIndex(function(e){return e._id==t._id});e.records.splice(o,1),e.records=(0,s.ev)([],(0,s.CR)(e.records))})},e.prototype.ngOnInit=function(){this.years=this.commonService.getYears(),this.months=this.commonService.getMonthList(),this.getEmployees(),this.getData()},e.prototype.getEmployees=function(){return(0,s.mG)(this,void 0,void 0,function(){var e;return(0,s.Jh)(this,function(t){switch(t.label){case 0:return[4,this.apiService.get(this.urlHandler.url.employee.get_employee)];case 1:return(e=t.sent()).success&&(this.employeeList=e.body),[2]}})})},e.prototype.getData=function(){return(0,s.mG)(this,void 0,void 0,function(){var e;return(0,s.Jh)(this,function(t){switch(t.label){case 0:return[4,this.apiService.get(this.urlHandler.url.employee_salary.get_salaries+"?employeeId="+this.model.selectedEmployee+"&year="+this.model.year+"&month="+this.model.month)];case 1:return(e=t.sent()).success&&(this.records=e.body),[2]}})})},e.prototype.onAddPopupClose=function(e){this.showPopup=!1},e.\u0275fac=function(t){return new(t||e)(p.Y36(m.s),p.Y36(g.n),p.Y36(h.z),p.Y36(y.b),p.Y36(f.sk),p.Y36(n.uU),p.Y36(b.v_),p.Y36(Z.a))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-salary-report"]],decls:50,vars:36,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header","p-0"],[1,"row"],[1,"form-group","col-md-2","ml-4","p-0"],["for","selectedEmployee",1,"col-sm-12","col-form-label"],[1,"col-sm-12"],["id","selectedEmployee","name","employee",1,"form-control",3,"ngModel","change","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","col-md-2","m-0","p-0"],["id","year","name","year","required","",1,"form-control",3,"ngModel","change","ngModelChange"],["id","month","name","month","required","",1,"form-control",3,"ngModel","change","ngModelChange"],[1,"m-0"],["type","button","data-toggle","modal","data-original-title","test","data-target","#exampleModal",1,"btn","btn-primary","mt-4-5",3,"click"],[1,"form-group","col-md-3","m-0","p-0"],["type","button","data-toggle","modal","data-original-title","test","data-target","#exampleModal",1,"btn","btn-primary","mt-4-5","pull-right",3,"click"],[1,"fa","fa-plus"],[1,"card-body","vendor-table"],["id","batchDelete",1,"custom-datatable","vendor-list"],[1,"table-responsive"],[3,"settings","source"],[3,"showPopup","onPopupClose"]],template:function(e,t){1&e&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"div",2),p.TgZ(3,"div",3),p.TgZ(4,"div",4),p.TgZ(5,"label",5),p._uU(6),p.ALo(7,"i18n"),p.qZA(),p.TgZ(8,"div",6),p.TgZ(9,"select",7),p.NdJ("change",function(){return t.getData()})("ngModelChange",function(e){return t.model.selectedEmployee=e}),p.TgZ(10,"option",8),p._uU(11),p.ALo(12,"i18n"),p.qZA(),p.YNc(13,$,2,2,"option",9),p.qZA(),p.qZA(),p.qZA(),p.TgZ(14,"div",10),p.TgZ(15,"label",5),p._uU(16),p.ALo(17,"i18n"),p.qZA(),p.TgZ(18,"div",6),p.TgZ(19,"select",11),p.NdJ("change",function(){return t.getData()})("ngModelChange",function(e){return t.model.year=e}),p.TgZ(20,"option",8),p._uU(21),p.ALo(22,"i18n"),p.qZA(),p.YNc(23,V,2,2,"option",9),p.qZA(),p.qZA(),p.qZA(),p.TgZ(24,"div",10),p.TgZ(25,"label",5),p._uU(26),p.ALo(27,"i18n"),p.qZA(),p.TgZ(28,"div",6),p.TgZ(29,"select",12),p.NdJ("change",function(){return t.getData()})("ngModelChange",function(e){return t.model.month=e}),p.TgZ(30,"option",8),p._uU(31),p.ALo(32,"i18n"),p.qZA(),p.YNc(33,W,2,2,"option",9),p.qZA(),p.qZA(),p.qZA(),p.TgZ(34,"div",10),p.TgZ(35,"h5",13),p.TgZ(36,"button",14),p.NdJ("click",function(){return t.getData()}),p._uU(37),p.ALo(38,"i18n"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(39,"div",15),p.TgZ(40,"h5",13),p.TgZ(41,"button",16),p.NdJ("click",function(){return t.showPopup=!0}),p._UZ(42,"i",17),p._uU(43),p.ALo(44,"i18n"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(45,"div",18),p.TgZ(46,"div",19),p.TgZ(47,"div",20),p._UZ(48,"ng2-smart-table",21),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(49,"app-pay-salary",22),p.NdJ("onPopupClose",function(e){return t.onAddPopupClose(e)}),p.qZA()),2&e&&(p.xp6(6),p.hij(" ",p.lcZ(7,20,"text_employee"),""),p.xp6(3),p.Q6J("ngModel",t.model.selectedEmployee),p.xp6(1),p.Q6J("value",-1),p.xp6(1),p.Oqu(p.lcZ(12,22,"text_all")),p.xp6(2),p.Q6J("ngForOf",t.employeeList),p.xp6(3),p.hij(" ",p.lcZ(17,24,"text_years"),""),p.xp6(3),p.Q6J("ngModel",t.model.year),p.xp6(1),p.Q6J("value",-1),p.xp6(1),p.Oqu(p.lcZ(22,26,"text_all")),p.xp6(2),p.Q6J("ngForOf",t.years),p.xp6(3),p.hij(" ",p.lcZ(27,28,"text_months"),""),p.xp6(3),p.Q6J("ngModel",t.model.month),p.xp6(1),p.Q6J("value",-1),p.xp6(1),p.Oqu(p.lcZ(32,30,"text_all")),p.xp6(2),p.Q6J("ngForOf",t.months),p.xp6(4),p.hij(" ",p.lcZ(38,32,"text_search"),""),p.xp6(6),p.hij(" ",p.lcZ(44,34,"text_salary"),""),p.xp6(5),p.Q6J("settings",t.settings)("source",t.records),p.xp6(1),p.Q6J("showPopup",t.showPopup))},directives:[_.EJ,_.JJ,_.On,_.YN,_.Kr,n.sg,_.Q7,v.T5,B],pipes:[q.X],styles:[""]}),e}(),data:{title:"text_salaryReport",breadcrumb:"text_salaryReport",id:r.AN.SalaryReport}},{canActivate:[l.e],path:"salary-detail/:employeeId/:name",component:X,data:{title:"Salary detail",breadcrumb:"Salary detail",id:r.AN.SalaryReport}}],oe=function(){function e(){}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[i.Bz.forChild(te)],i.Bz]}),e}(),ne=o(75425),ie=function(){function e(){}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[n.ez,oe,_.UX,x.IJ,v.ne,ne.m,_.u5]]}),e}()}}]);