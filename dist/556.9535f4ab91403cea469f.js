(self.webpackChunkgotec_pos=self.webpackChunkgotec_pos||[]).push([[556],{79556:function(t,e,n){"use strict";n.r(e),n.d(e,{InventoryModule:function(){return Ut}});var i=n(61116),o=n(25548),r=n(42590),l=n(76675),s=n(64762),a=function(){return function(){this.autoBarcode=!0,this.exRetailSalesTax=!0,this.package={}}}(),c=function(){return function(){this.totalPurchasePrice=0,this.totalRetailPrice=0,this.totalWholesalePrice=0,this.totalQuantity=0,this.shipping=0,this.discount=0,this.isDiscountPercentage=0}}(),u=n(39481),d=n(83361),p=n(47671),g=n(529),h=n(40920),m=n(93820),f=n(47988),v=n(93957),Z=n(66425),y=n(5282),b=n(11462),A=n(63978),w=function(t){function e(e,n,i,o,r){var l=t.call(this)||this;return l.commonService=e,l.authGuard=n,l.apiService=i,l.urlHandler=o,l.completerService=r,l.brands=[],l.user=new d.n,l.user=l.authGuard.getLoggedInUser(),l.getBrands(),l}return(0,s.ZT)(e,t),e.prototype.ngOnInit=function(){this.searchQuery=this.cell.getValue()},e.prototype.focus=function(){this.dataService=this.completerService.local(this.brands,"name","name")},e.prototype.getBrands=function(){return(0,s.mG)(this,void 0,void 0,function(){var t;return(0,s.Jh)(this,function(e){switch(e.label){case 0:return[4,this.apiService.get(this.urlHandler.url.brand.get_brands)];case 1:return t=e.sent(),this.brands=t.body,[2]}})})},e.prototype.select=function(t){this.searchQuery=t.name,console.log(t)},e.prototype.selected=function(t){this.cell.newValue=t.originalObject},e.prototype.ngAfterViewInit=function(){},e.\u0275fac=function(t){return new(t||e)(m.Y36(p.v_),m.Y36(f.a),m.Y36(v.s),m.Y36(Z.z),m.Y36(y.Jh))},e.\u0275cmp=m.Xpm({type:e,selectors:[["ng-component"]],features:[m.qOj],decls:2,vars:6,consts:[[3,"placeholder","ngModel","datasource","minSearchLength","focus","selected","ngModelChange"]],template:function(t,e){1&t&&(m.TgZ(0,"ng2-completer",0),m.NdJ("focus",function(){return e.focus()})("selected",function(t){return e.selected(t)})("ngModelChange",function(t){return e.searchQuery=t}),m.ALo(1,"i18n"),m.qZA()),2&t&&m.Q6J("placeholder",m.lcZ(1,4,"text_search"))("ngModel",e.searchQuery)("datasource",e.dataService)("minSearchLength",0)},directives:[y.nl,b.JJ,b.On],pipes:[A.X],styles:["wid[_ngcontent-%COMP%]{width:10%}"]}),e}(h.U5),T=n(4244),q=function(t){function e(e,n){var i=t.call(this)||this;return i.authGuard=e,i.events=n,i.user=new d.n,i.user=i.authGuard.getLoggedInUser(),i}return(0,s.ZT)(e,t),e.\u0275fac=function(t){return new(t||e)(m.Y36(f.a),m.Y36(T.n))},e.\u0275cmp=m.Xpm({type:e,selectors:[["input-editor"]],inputs:{value:"value",rowData:"rowData"},features:[m.qOj],decls:1,vars:4,consts:[["type","number",2,"width","100%",3,"ngModel","name","placeholder","disabled","ngModelChange","click","keydown.enter","keydown.esc"]],template:function(t,e){1&t&&(m.TgZ(0,"input",0),m.NdJ("ngModelChange",function(t){return e.cell.newValue=t})("click",function(t){return e.onClick.emit(t)})("keydown.enter",function(t){return e.onEdited.emit(t)})("keydown.esc",function(){return e.onStopEditing.emit()}),m.qZA()),2&t&&m.Q6J("ngModel",e.cell.newValue)("name",e.cell.getId())("placeholder",e.cell.getTitle())("disabled",!e.cell.isEditable())},directives:[b.wV,b.Fj,b.JJ,b.On],encapsulation:2}),e}(h.U5);function x(t,e){if(1&t&&(m.TgZ(0,"span",2),m.TgZ(1,"small"),m._uU(2),m.qZA(),m.qZA()),2&t){var n=m.oxw();m.xp6(2),m.AsE(" ",null==n.cell.newValue?null:n.cell.newValue.salesTax,"% | ",null==n.cell.newValue?null:n.cell.newValue.tariffCode," ")}}var C=function(t){function e(e,n,i,o,r,s){var a=t.call(this)||this;a.commonService=e,a.authGuard=n,a.apiService=i,a.urlHandler=o,a.completerService=r,a.events=s,a.products=[],a.user=new d.n,a.selectedProduct=new u.x,a.user=a.authGuard.getLoggedInUser(),a.user.businessType.id==l.Pu.MedicalStore||a.user.businessType.id==l.Pu.GrocceryStore?(a.getAllDrugsList(),a.isGrocery=!0):a.getProducts();var c=localStorage.getItem("isNewBarcode");return c&&"undefined"!=c&&(a.isNewBarcode=JSON.parse(c)),a.events.subscribe("onIsNewBarcode",function(t){a.isNewBarcode=t;var e=a.cell.getRow().getNewData();a.isNewBarcode||(e.barcode=null),a.cell.getRow().setData(e)}),a}return(0,s.ZT)(e,t),e.prototype.ngOnInit=function(){this.searchQuery=this.cell.getValue()},e.prototype.focus=function(){this.dataService=this.completerService.local(this.products,"name","name")},e.prototype.getProducts=function(){return(0,s.mG)(this,void 0,void 0,function(){var t;return(0,s.Jh)(this,function(e){switch(e.label){case 0:return[4,this.apiService.get(this.urlHandler.url.product.get_products)];case 1:return t=e.sent(),this.products=t.body,[2]}})})},e.prototype.getAllDrugsList=function(){return(0,s.mG)(this,void 0,void 0,function(){var t,e;return(0,s.Jh)(this,function(n){switch(n.label){case 0:return this.user.businessType.id==l.Pu.MedicalStore?t=this.urlHandler.url.product.search_drugs_list+"?query="+(this.searchQuery||"a"):this.user.businessType.id==l.Pu.GrocceryStore&&(t=this.urlHandler.url.product.search_grocery_list+"?query="+(this.searchQuery||"a")),[4,this.apiService.get(t)];case 1:return e=n.sent(),this.products=e.body,this.dataService=this.completerService.local(this.products,"name","name"),[2]}})})},e.prototype.selected=function(t){return(0,s.mG)(this,void 0,void 0,function(){var e,n,i;return(0,s.Jh)(this,function(o){switch(o.label){case 0:return t?(this.cell.newValue=t.originalObject,[4,this.apiService.get(this.urlHandler.url.inventory.search_inventory_item_by_product+"?product="+t.originalObject._id)]):[3,2];case 1:e=o.sent(),(n=e.body)&&(i=this.cell.getRow().getNewData(),this.isNewBarcode||(i.barcode=n.barcode),i.retailPrice=n.retailPrice,i.purchasePrice=n.purchasePrice,i.exRetailSalesTax=n.exRetailSalesTax,i.size=n.size,i.color=n.color,i.design=n.design,i.brand=n.brand,i.isReceivedDiscPercentage=!1,this.cell.getRow().setData(i)),o.label=2;case 2:return[2]}})})},e.prototype.ngAfterViewInit=function(){},e.\u0275fac=function(t){return new(t||e)(m.Y36(p.v_),m.Y36(f.a),m.Y36(v.s),m.Y36(Z.z),m.Y36(y.Jh),m.Y36(T.n))},e.\u0275cmp=m.Xpm({type:e,selectors:[["ng-component"]],features:[m.qOj],decls:3,vars:7,consts:[[3,"placeholder","ngModel","datasource","minSearchLength","focus","selected","keyup","ngModelChange"],["style","position: absolute;background: green;color: white;min-width:80px;padding-left: 2px;",4,"ngIf"],[2,"position","absolute","background","green","color","white","min-width","80px","padding-left","2px"]],template:function(t,e){1&t&&(m.TgZ(0,"ng2-completer",0),m.NdJ("focus",function(){return e.focus()})("selected",function(t){return e.selected(t)})("keyup",function(){return e.isGrocery&&e.getAllDrugsList()})("ngModelChange",function(t){return e.searchQuery=t}),m.ALo(1,"i18n"),m.qZA(),m.YNc(2,x,3,2,"span",1)),2&t&&(m.Q6J("placeholder",m.lcZ(1,5,"text_search"))("ngModel",e.searchQuery)("datasource",e.dataService)("minSearchLength",0),m.xp6(2),m.Q6J("ngIf",null==e.user||null==e.user.company?null:e.user.company.POSID))},directives:[y.nl,b.JJ,b.On,i.O5],pipes:[A.X],styles:["table-cell-custom-editor .completer-holder input{padding:2px!important}"]}),e}(h.U5),P=function(t){function e(e,n){var i=t.call(this)||this;return i.authGuard=e,i.events=n,i.user=new d.n,i.user=i.authGuard.getLoggedInUser(),i}return(0,s.ZT)(e,t),e.\u0275fac=function(t){return new(t||e)(m.Y36(f.a),m.Y36(T.n))},e.\u0275cmp=m.Xpm({type:e,selectors:[["input-editor"]],inputs:{value:"value",rowData:"rowData"},features:[m.qOj],decls:1,vars:4,consts:[["type","number",2,"width","100%",3,"ngModel","name","placeholder","disabled","ngModelChange","click","keydown.enter","keydown.esc"]],template:function(t,e){1&t&&(m.TgZ(0,"input",0),m.NdJ("ngModelChange",function(t){return e.cell.newValue=t})("click",function(t){return e.onClick.emit(t)})("keydown.enter",function(t){return e.onEdited.emit(t)})("keydown.esc",function(){return e.onStopEditing.emit()}),m.qZA()),2&t&&m.Q6J("ngModel",e.cell.newValue)("name",e.cell.getId())("placeholder",e.cell.getTitle())("disabled",!e.cell.isEditable())},directives:[b.wV,b.Fj,b.JJ,b.On],encapsulation:2}),e}(h.U5),_=function(t){function e(e,n){var i=t.call(this)||this;return i.authGuard=e,i.events=n,i.user=new d.n,i.user=i.authGuard.getLoggedInUser(),i}return(0,s.ZT)(e,t),e.\u0275fac=function(t){return new(t||e)(m.Y36(f.a),m.Y36(T.n))},e.\u0275cmp=m.Xpm({type:e,selectors:[["input-editor"]],inputs:{value:"value",rowData:"rowData"},features:[m.qOj],decls:1,vars:4,consts:[["type","number",2,"width","100%",3,"ngModel","name","placeholder","disabled","ngModelChange","click","keydown.enter","keydown.esc"]],template:function(t,e){1&t&&(m.TgZ(0,"input",0),m.NdJ("ngModelChange",function(t){return e.cell.newValue=t})("click",function(t){return e.onClick.emit(t)})("keydown.enter",function(t){return e.onEdited.emit(t)})("keydown.esc",function(){return e.onStopEditing.emit()}),m.qZA()),2&t&&m.Q6J("ngModel",e.cell.newValue)("name",e.cell.getId())("placeholder",e.cell.getTitle())("disabled",!e.cell.isEditable())},directives:[b.wV,b.Fj,b.JJ,b.On],encapsulation:2}),e}(h.U5),M=function(t){function e(e,n){var i=t.call(this)||this;return i.authGuard=e,i.events=n,i.user=new d.n,i.user=i.authGuard.getLoggedInUser(),setTimeout(function(){if(i.cell){var t=i.cell.getRow().getNewData();i.isReceivedDiscPercentage=t.isReceivedDiscPercentage}}),i}return(0,s.ZT)(e,t),e.prototype.fieldChange=function(){this.events.publish("inventory:isReceivedDiscPercentage",this.isReceivedDiscPercentage)},e.\u0275fac=function(t){return new(t||e)(m.Y36(f.a),m.Y36(T.n))},e.\u0275cmp=m.Xpm({type:e,selectors:[["input-editor"]],inputs:{value:"value",rowData:"rowData"},features:[m.qOj],decls:5,vars:5,consts:[["placeholder","''","type","number",1,"pull-left",2,"width","70%",3,"ngModel","name","placeholder","disabled","ngModelChange","click","keydown.enter","keydown.esc"],[1,"m-0","pull-left"],["type","checkbox",2,"width","fit-content",3,"ngModel","change","ngModelChange"]],template:function(t,e){1&t&&(m.TgZ(0,"input",0),m.NdJ("ngModelChange",function(t){return e.cell.newValue=t})("click",function(t){return e.onClick.emit(t)})("keydown.enter",function(t){return e.onEdited.emit(t)})("keydown.esc",function(){return e.onStopEditing.emit()}),m.qZA(),m.TgZ(1,"span"),m.TgZ(2,"label",1),m.TgZ(3,"input",2),m.NdJ("change",function(){return e.fieldChange()})("ngModelChange",function(t){return e.isReceivedDiscPercentage=t}),m.qZA(),m._uU(4," % "),m.qZA(),m.qZA()),2&t&&(m.Q6J("ngModel",e.cell.newValue)("name",e.cell.getId())("placeholder",e.cell.getTitle())("disabled",!e.cell.isEditable()),m.xp6(3),m.Q6J("ngModel",e.isReceivedDiscPercentage))},directives:[b.wV,b.Fj,b.JJ,b.On,b.Wl],encapsulation:2}),e}(h.U5);function k(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"span"),m.TgZ(1,"label",2),m.TgZ(2,"input",3),m.NdJ("change",function(){return m.CHM(n),m.oxw().fieldChange()})("ngModelChange",function(t){return m.CHM(n),m.oxw().exRetailSalesTax=t}),m.qZA(),m._uU(3," (Ex. GST) "),m.qZA(),m.qZA()}if(2&t){var i=m.oxw();m.xp6(2),m.Q6J("ngModel",i.exRetailSalesTax)}}var S=function(t){function e(e,n){var i=t.call(this)||this;return i.authGuard=e,i.events=n,i.user=new d.n,i.user=i.authGuard.getLoggedInUser(),setTimeout(function(){if(i.cell){var t=i.cell.getRow().getNewData();i.exRetailSalesTax=t.exRetailSalesTax}}),i}return(0,s.ZT)(e,t),e.prototype.fieldChange=function(){this.events.publish("inventory:exRetailSalesTax",this.exRetailSalesTax)},e.\u0275fac=function(t){return new(t||e)(m.Y36(f.a),m.Y36(T.n))},e.\u0275cmp=m.Xpm({type:e,selectors:[["input-editor"]],inputs:{value:"value",rowData:"rowData"},features:[m.qOj],decls:2,vars:5,consts:[["type","number",1,"pull-left",2,"width","55%",3,"ngModel","name","placeholder","disabled","ngModelChange","click","keydown.enter","keydown.esc"],[4,"ngIf"],[1,"m-0","pull-left"],["type","checkbox",2,"width","fit-content",3,"ngModel","change","ngModelChange"]],template:function(t,e){1&t&&(m.TgZ(0,"input",0),m.NdJ("ngModelChange",function(t){return e.cell.newValue=t})("click",function(t){return e.onClick.emit(t)})("keydown.enter",function(t){return e.onEdited.emit(t)})("keydown.esc",function(){return e.onStopEditing.emit()}),m.qZA(),m.YNc(1,k,4,1,"span",1)),2&t&&(m.Q6J("ngModel",e.cell.newValue)("name",e.cell.getId())("placeholder",e.cell.getTitle())("disabled",!e.cell.isEditable()),m.xp6(1),m.Q6J("ngIf",null==e.user||null==e.user.company?null:e.user.company.POSID))},directives:[b.wV,b.Fj,b.JJ,b.On,i.O5,b.Wl],encapsulation:2}),e}(h.U5),J=function(t){function e(e,n){var i=t.call(this)||this;return i.authGuard=e,i.events=n,i.user=new d.n,i.user=i.authGuard.getLoggedInUser(),setTimeout(function(){if(i.cell){var t=i.cell.getRow().getNewData();i.isCommissionPercent=t.isCommissionPercent}}),i}return(0,s.ZT)(e,t),e.prototype.fieldChange=function(){var t=this.cell.getRow().getNewData();t.isCommissionPercent=this.isCommissionPercent,this.cell.getRow().setData(t)},e.\u0275fac=function(t){return new(t||e)(m.Y36(f.a),m.Y36(T.n))},e.\u0275cmp=m.Xpm({type:e,selectors:[["input-editor"]],inputs:{value:"value",rowData:"rowData"},features:[m.qOj],decls:2,vars:4,consts:[["type","number",1,"pull-left",2,"width","100%",3,"ngModel","name","placeholder","disabled","ngModelChange","click","keydown.enter","keydown.esc"]],template:function(t,e){1&t&&(m.TgZ(0,"input",0),m.NdJ("ngModelChange",function(t){return e.cell.newValue=t})("click",function(t){return e.onClick.emit(t)})("keydown.enter",function(t){return e.onEdited.emit(t)})("keydown.esc",function(){return e.onStopEditing.emit()}),m.qZA(),m._UZ(1,"span")),2&t&&m.Q6J("ngModel",e.cell.newValue)("name",e.cell.getId())("placeholder",e.cell.getTitle())("disabled",!e.cell.isEditable())},directives:[b.wV,b.Fj,b.JJ,b.On],encapsulation:2}),e}(h.U5),N=n(36212),U=n(40068),D=function(){function t(t){this.router=t,this.isPrinting=!1}return t.prototype.onDataReady=function(){var t=this;console.log("on data ready"),setTimeout(function(){var e,n;t.isPrinting=!1,e=document.getElementById("print-section").innerHTML,(n=window.open("","_blank","top=0,left=0,height=100%,width=auto")).document.open(),n.document.write('\n      <html>\n        <head>\n          <title>Print tab</title>\n          <style>\n           .label{\n        float: left;\n        text-align: left;\n        overflow: hidden; \n        }\n    .page-break  {\n        clear: left;\n        display:block;\n        page-break-after:always;\n      }\n\n@media screen {\n  :host {\n    display: none;\n  }\n}\n.invoice {\n  page-break-after: always;\n}\n\n.invoice:last-child {\n  page-break-after: avoid;\n}\n\n\n          </style>\n        </head>\n    <body onload="window.print();window.close()">'+e+"</body>\n      </html>"),n.document.close()})},t.\u0275fac=function(e){return new(e||t)(m.LFG(o.F0))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),O=n(33004);function L(t,e){if(1&t&&(m.TgZ(0,"td",22),m.TgZ(1,"small",29),m._uU(2),m.qZA(),m.qZA()),2&t){var n=m.oxw().$implicit;m.xp6(2),m.AsE(" ",null==n||null==n.brand_doc||null==n.brand_doc.name?null:n.brand_doc.name.substring(0,1).toUpperCase(),"",null==n||null==n.brand_doc||null==n.brand_doc.name?null:n.brand_doc.name.substring(1,10).toLowerCase()," ")}}var R=function(t){return{"margin-right":t}};function I(t,e){if(1&t&&(m.TgZ(0,"small",30),m._uU(1),m.qZA()),2&t){var n=m.oxw(),i=n.index,o=n.$implicit;m.Q6J("ngStyle",m.VKq(2,R,(i+1)%2==0&&0!=i?"13px":"0")),m.xp6(1),m.hij(" ",null==o?null:o.size_doc.name," ")}}var B=function(t){return{"page-break":t}};function F(t,e){if(1&t&&(m.TgZ(0,"div",10),m._UZ(1,"div",11),m.TgZ(2,"div",12),m.TgZ(3,"div",13),m.TgZ(4,"table",14),m.TgZ(5,"tr"),m.TgZ(6,"td",15),m.TgZ(7,"small",16),m._uU(8),m.qZA(),m.qZA(),m.TgZ(9,"td",15),m.TgZ(10,"small",17),m._uU(11),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(12,"table",18),m.TgZ(13,"tr"),m.TgZ(14,"td",19),m.TgZ(15,"small"),m._uU(16),m.qZA(),m.qZA(),m.qZA(),m.TgZ(17,"tr"),m.TgZ(18,"td"),m._UZ(19,"ngx-barcode",20),m.qZA(),m.qZA(),m.qZA(),m.TgZ(20,"table",21),m.TgZ(21,"tr"),m.TgZ(22,"td",22),m.TgZ(23,"small",23),m._uU(24),m.qZA(),m.qZA(),m.YNc(25,L,3,2,"td",24),m.qZA(),m.qZA(),m.qZA(),m.TgZ(26,"div",25),m.TgZ(27,"table",13),m.TgZ(28,"tr"),m.TgZ(29,"td",26),m.TgZ(30,"span"),m.TgZ(31,"small",18),m.TgZ(32,"small",27),m._uU(33),m.qZA(),m.qZA(),m.YNc(34,I,2,4,"small",28),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t){var n=e.$implicit,i=e.index,o=m.oxw(2);m.xp6(1),m.Q6J("ngClass",m.VKq(19,B,0!==i)),m.xp6(7),m.Oqu(n.itemCode),m.xp6(3),m.Oqu(null==n||null==n.design?null:n.design.name),m.xp6(5),m.Oqu(null==o.currentUser||null==o.currentUser.company?null:o.currentUser.company.name),m.xp6(3),m.s9C("bc-value",n.barcode),m.Q6J("bc-width",o.width)("bc-text-margin",o.textMargin)("bc-margin-bottom",o.marginBottom)("bc-margin",o.margin)("bc-margin-top",o.marginTop)("bc-font-size",o.fontSize)("bc-height",o.barcodeHeight)("bc-display-value",!0),m.xp6(5),m.AsE("",null==o.currentUser||null==o.currentUser.company||null==o.currentUser.company.country||null==o.currentUser.company.country.currency?null:o.currentUser.company.country.currency.symbol," ",null==n?null:n.retailPrice,""),m.xp6(1),m.Q6J("ngIf",n.brand_doc),m.xp6(8),m.AsE(" ",null==n||null==n.product_doc||null==n.product_doc.name?null:n.product_doc.name.substring(0,1).toUpperCase(),"",null==n||null==n.product_doc||null==n.product_doc.name?null:n.product_doc.name.substring(1,20).toLowerCase(),""),m.xp6(1),m.Q6J("ngIf",n.size_doc)}}function Y(t,e){if(1&t&&(m.TgZ(0,"div",8),m.YNc(1,F,35,21,"div",9),m.qZA()),2&t){var n=m.oxw();m.xp6(1),m.Q6J("ngForOf",n.barcodePrintList)}}function Q(t,e){if(1&t&&(m.TgZ(0,"td",22),m.TgZ(1,"small",29),m._uU(2),m.qZA(),m.qZA()),2&t){var n=m.oxw().$implicit;m.xp6(2),m.AsE(" ",null==n?null:n.brand_doc.name.substring(0,1).toUpperCase(),"",null==n?null:n.brand_doc.name.substring(1,10).toLowerCase()," ")}}function G(t,e){if(1&t&&(m.TgZ(0,"small",30),m._uU(1),m.qZA()),2&t){var n=m.oxw(),i=n.index,o=n.$implicit;m.Q6J("ngStyle",m.VKq(2,R,(i+1)%2==0&&0!=i?"13px":"0")),m.xp6(1),m.hij(" ",null==o?null:o.size_doc.name," ")}}var j=function(t){return{float:t}},E=function(t){return{"margin-left":t}};function H(t,e){if(1&t&&(m.TgZ(0,"div",32),m._UZ(1,"div",11),m.TgZ(2,"div",12),m.TgZ(3,"div",13),m.TgZ(4,"table",33),m.TgZ(5,"tr"),m.TgZ(6,"td",15),m.TgZ(7,"small",16),m._uU(8),m.qZA(),m.qZA(),m.TgZ(9,"td",15),m.TgZ(10,"small",17),m._uU(11),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(12,"table",18),m.TgZ(13,"tr"),m.TgZ(14,"td",19),m.TgZ(15,"small"),m._uU(16),m.qZA(),m.qZA(),m.qZA(),m.TgZ(17,"tr"),m.TgZ(18,"td"),m._UZ(19,"ngx-barcode",20),m.qZA(),m.qZA(),m.qZA(),m.TgZ(20,"table",21),m.TgZ(21,"tr"),m.TgZ(22,"td",22),m.TgZ(23,"small",23),m._uU(24),m.qZA(),m.qZA(),m.YNc(25,Q,3,2,"td",24),m.qZA(),m.qZA(),m.qZA(),m.TgZ(26,"div",34),m.TgZ(27,"table",35),m.TgZ(28,"tr"),m.TgZ(29,"td",26),m.TgZ(30,"span"),m.TgZ(31,"small",18),m.TgZ(32,"small",27),m._uU(33),m.qZA(),m.qZA(),m.YNc(34,G,2,4,"small",28),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&t){var n=e.$implicit,i=e.index,o=m.oxw(2);m.Q6J("ngStyle",m.VKq(22,j,(i+1)%2==0&&0!=i?"right":"left")),m.xp6(1),m.Q6J("ngClass",m.VKq(24,B,0!=i&&1!=i)),m.xp6(3),m.Q6J("ngStyle",m.VKq(26,E,(i+1)%2==0&&0!=i?"13px":"0")),m.xp6(4),m.Oqu(n.itemCode),m.xp6(3),m.Oqu(null==n||null==n.design?null:n.design.name),m.xp6(5),m.Oqu(null==o.currentUser||null==o.currentUser.company?null:o.currentUser.company.name),m.xp6(3),m.s9C("bc-value",n.barcode),m.Q6J("bc-width",o.width)("bc-text-margin",o.textMargin)("bc-margin-bottom",o.marginBottom)("bc-margin",o.margin)("bc-margin-top",o.marginTop)("bc-font-size",o.fontSize)("bc-height",o.barcodeHeight)("bc-display-value",!0),m.xp6(5),m.AsE("",null==o.currentUser||null==o.currentUser.company||null==o.currentUser.company.country||null==o.currentUser.company.country.currency?null:o.currentUser.company.country.currency.symbol," ",null==n?null:n.retailPrice,""),m.xp6(1),m.Q6J("ngIf",n.brand_doc),m.xp6(2),m.Q6J("ngStyle",m.VKq(28,E,(i+1)%2==0&&0!=i?"13px":"0")),m.xp6(6),m.AsE(" ",null==n?null:n.product_doc.name.substring(0,1).toUpperCase(),"",null==n?null:n.product_doc.name.substring(1,20).toLowerCase(),""),m.xp6(1),m.Q6J("ngIf",n.size_doc)}}function z(t,e){if(1&t&&(m.TgZ(0,"div",8),m.YNc(1,H,35,30,"div",31),m.qZA()),2&t){var n=m.oxw();m.xp6(1),m.Q6J("ngForOf",n.barcodePrintList)}}var V=function(){function t(t,e,n,i){this.printService=e,this.authService=n,this.authGuard=i,this.barcodePrintList=[],this.fontSize=12,this.barcodeHeight=28,this.width=1,this.marginTop=0,this.marginBottom=0,this.margin=0,this.textMargin=0,this.currentUser=this.authGuard.getLoggedInUser(),this.inventoryId=t.snapshot.params.inventoryId,this.itemName=t.snapshot.params.itemName,this.salesPrice=t.snapshot.params.salesPrice,this.barcode=t.snapshot.params.barcode,this.product=t.snapshot.params.product,this.size=t.snapshot.params.size,this.brand=t.snapshot.params.brand,this.quantity=parseInt(t.snapshot.params.quantity),parseFloat(this.barcode)>999999&&(this.width=.2,this.fontSize=10)}return t.prototype.ngOnChanges=function(){this.defaultPrinter||(this.defaultPrinter=1)},t.prototype.ngOnInit=function(){console.log(this.barcodePrintList),this.barcodePrintList.length&&this.printService.onDataReady()},t.prototype.onPrint=function(){this.printService.onDataReady()},t.\u0275fac=function(e){return new(e||t)(m.Y36(o.gz),m.Y36(D),m.Y36(r.e),m.Y36(f.a))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-print-barcode"]],inputs:{billNumber:"billNumber",barcodePrintList:"barcodePrintList",defaultPrinter:"defaultPrinter"},features:[m.TTD],decls:11,vars:2,consts:[[1,"invoice"],["fxLayout","column",1,"components-container-gt-xs"],["fxFlex","",1,"input-component-holder","mat-elevation-z4"],[1,"input-header"],[1,"mat-headline","center-align",2,"width","100%"],["mat-raised-button","","color","primary",2,"float","right",3,"click"],["aria-hidden","true",1,"fa","fa-barcode"],["id","print-section",4,"ngIf"],["id","print-section"],["style","text-align:center;width:100%;padding: 0;margin: 0;",4,"ngFor","ngForOf"],[2,"text-align","center","width","100%","padding","0","margin","0"],[3,"ngClass"],[1,"label",2,"text-align","left"],[2,"width","100%"],[2,"float","left","line-height","6px","margin-left","0"],[2,"height","60px"],[2,"writing-mode","tb-rl","margin-top","0px","font-weight","700","font-size","x-small"],[2,"writing-mode","tb-rl","margin-top","0px","font-weight","600","font-size","xx-small"],[2,"float","left"],["colspan","3",2,"text-align","center"],[3,"bc-width","bc-text-margin","bc-margin-bottom","bc-margin","bc-margin-top","bc-font-size","bc-height","bc-value","bc-display-value"],[2,"float","right","line-height","8px"],[2,"height","63px"],[2,"writing-mode","tb-rl","font-weight","700","font-size","small",";margin-top","0px"],["style","height:63px;",4,"ngIf"],[2,"width","100%","float","left","text-align","-webkit-center","line-height","5px"],["colspan","3"],[2,"font-size","xx-small","font-weight","600"],["style","float:right",3,"ngStyle",4,"ngIf"],[2,"writing-mode","tb-rl","font-weight","700","font-size","x-small","margin-top","0px"],[2,"float","right",3,"ngStyle"],["style","text-align:center;width:50%;",3,"ngStyle",4,"ngFor","ngForOf"],[2,"text-align","center","width","50%",3,"ngStyle"],[2,"float","left","line-height","6px",3,"ngStyle"],[2,"width","100%","float","left","text-align","-webkit-center"],[2,"width","100%",3,"ngStyle"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"h1",4),m._uU(5,"Barcodes"),m.qZA(),m.TgZ(6,"button",5),m.NdJ("click",function(){return e.onPrint()}),m._UZ(7,"i",6),m._uU(8," Print"),m.qZA(),m.qZA(),m.YNc(9,Y,2,1,"div",7),m.YNc(10,z,2,1,"div",7),m.qZA(),m.qZA(),m.qZA()),2&t&&(m.xp6(9),m.Q6J("ngIf",1==e.defaultPrinter),m.xp6(1),m.Q6J("ngIf",2==e.defaultPrinter))},directives:[i.O5,i.sg,i.mk,O.y,i.PC],styles:[".label[_ngcontent-%COMP%]{background-color:#fff;float:left;text-align:left;overflow:hidden}.barcode[_ngcontent-%COMP%]{margin-top:-4px!important}.page-break[_ngcontent-%COMP%]{clear:left;display:block;page-break-after:always}"]}),t}(),W=n(45468),K=n(53083);function X(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"tr"),m.TgZ(1,"td",44),m.TgZ(2,"label",45),m.NdJ("change",function(){var t=m.CHM(n).$implicit;return m.oxw(2).applyColumnChanges(t)}),m._UZ(3,"input",46),m._uU(4),m.qZA(),m.qZA(),m.qZA()}if(2&t){var i=e.$implicit;m.xp6(3),m.Q6J("checked",!i.hide),m.xp6(1),m.hij(" ",i.text," ")}}function $(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"div",40),m.NdJ("click",function(){return m.CHM(n),m.oxw().showColumnPopup()}),m.TgZ(1,"button"),m._uU(2," Show columns"),m.qZA(),m.TgZ(3,"div",41),m.TgZ(4,"table",42),m.YNc(5,X,5,2,"tr",43),m.qZA(),m.qZA(),m.qZA()}if(2&t){var i=m.oxw();m.xp6(5),m.Q6J("ngForOf",i.columns)}}function tt(t,e){if(1&t&&(m.TgZ(0,"option",47),m._uU(1),m.qZA()),2&t){var n=e.$implicit;m.Q6J("value",n.id),m.xp6(1),m.hij("",n.title," ")}}var et=function(){return{standalone:!0}},nt=JSON.parse(localStorage.getItem("lang")),it=function(){function t(t,e,n,i,o,r,s,p,h,m,f,v){var Z=this;this.apiService=t,this.urlHandler=e,this.socket=n,this.datePipe=i,this.utilCtrl=o,this.authGuard=r,this.commonService=s,this.printService=p,this.events=h,this.changeDetector=m,this.completerService=f,this.activatedRoute=v,this.selectedStep=1,this.apiURL=g.N.apiUrl,this.products=[],this.brands=[],this.colors=[],this.sizes=[],this.designs=[],this.seasons=[],this.suppliers=[],this.units=[],this.model=new a,this.user=new d.n,this.features=l.AN,this.inventoryBill=new c,this.barcodeSettings=[{id:1,title:"1 in 1"},{id:2,title:"2 in 1"}],this.defaultPrinter=1,this.businessTypes=l.Pu,this.drugTypes=l.AE,this.settings={pager:{display:!0,perPage:100},actions:{},add:{addButtonContent:"",confirmCreate:!0},delete:{confirmDelete:!0,deleteButtonContent:""},edit:{confirmSave:!0,editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},columns:{product:{width:"15%",title:nt.text_product,type:"html",valuePrepareFunction:function(t,e){return t.name},editor:{type:"custom",component:C}},quantity:{width:"6%",title:nt.text_quantity,type:"text",editor:{type:"custom",component:_}},FOC:{width:"6%",title:nt.text_FOC,type:"number",editor:{type:"custom",component:q}},purchasePrice:{title:nt.text_purchasePrice,type:"text",valuePrepareFunction:function(t,e){return Z.user.company.country.currency.symbol+" "+t},editor:{type:"custom",component:P}},retailPrice:{title:nt.text_retailPrice,type:"html",valuePrepareFunction:function(t,e){return Z.user.company.country.currency.symbol+" "+t},editor:{type:"custom",component:S}}}},this.columns=[],this.selectedProduct=new u.x,this.inventories=[],this.barcodePrintList=[],this.selectedRows=[],this.getSuppliers(),this.supplierBillId=this.activatedRoute.snapshot.params.id,this.supplierBillId&&this.getSupplierBillById(),this.events.subscribe("inventory:exRetailSalesTax",function(t){Z.model.exRetailSalesTax=t}),this.events.subscribe("inventory:isReceivedDiscPercentage",function(t){Z.model.isReceivedDiscPercentage=t}),this.events.subscribe("onPrint",function(t){Z.barcodePrintList=[];for(var e=0;e<t.quantity;e++)Z.barcodePrintList.push(t);Z.printService.onDataReady()}),this.user=this.authGuard.getLoggedInUser(),localStorage.setItem("isNewBarcode",JSON.stringify(this.isNewBarcode))}return t.prototype.getSupplierBillById=function(){return(0,s.mG)(this,void 0,void 0,function(){var t,e;return(0,s.Jh)(this,function(n){switch(n.label){case 0:return[4,this.apiService.get(this.urlHandler.url.inventory.get_supplier_bill_by_id+"?id="+this.supplierBillId)];case 1:return t=n.sent(),e=t.body,t.body&&(this.inventoryBill._id=e._id,this.inventoryBill.billNo=e.billNo,this.inventoryBill.discount=e.discount,this.inventoryBill.totalPurchasePrice=e.totalPurchasePrice,this.inventoryBill.totalRetailPrice=e.totalRetailPrice,this.inventoryBill.isDiscountPercentage=e.isDiscountPercentage,this.inventories=e.inventories,e.supplier&&(this.inventoryBill.supplier=e.supplier._id,this.selectedSupplierName=e.supplier.name),this.settings.selectMode="multi",this.settings=Object.assign({},this.settings)),[2]}})})},t.prototype.focus=function(){this.dataService=this.completerService.local(this.suppliers,"name","name")},t.prototype.onSupplierSelected=function(t){t&&(this.inventoryBill.supplier=t.originalObject._id)},t.prototype.setColumns=function(){this.commonService.checkFeatureAllowed(l.AN.Brand)&&this.columns.push({value:"brand",text:"Brand",hide:!0}),this.commonService.checkFeatureAllowed(l.AN.Size)&&this.columns.push({value:"size",text:"Size",hide:!0}),this.commonService.checkFeatureAllowed(l.AN.Design)&&this.columns.push({value:"design",text:"Design",hide:!0}),this.commonService.checkFeatureAllowed(l.AN.Color)&&this.columns.push({value:"color",text:"Color",hide:!0}),this.settings.columns.barcode={title:nt.text_barcode,type:"string",width:"10%"},this.columns.push({value:"commisionAmount",text:"Commission",hide:!0}),this.columns.push({value:"receivedDiscount",text:"Received discount",hide:!0}),this.user.company.POSID&&(this.settings.columns.purchasePriceWithoutDiscount={title:"@ TaxPaid",type:"number"})},t.prototype.showColumnPopup=function(){document.getElementById("myPopup").classList.toggle("show")},t.prototype.applyColumnChanges=function(t){switch(t.hide=!t.hide,t.value){case"brand":t.hide?delete this.settings.columns.brand:this.settings.columns.brand={width:"10%",title:nt.text_brand,type:"html",valuePrepareFunction:function(t,e){if(t)return t.name},editor:{type:"custom",component:w}};break;case"size":t.hide?delete this.settings.columns.size:this.settings.columns.size={width:"10%",title:nt.text_size,type:"html",valuePrepareFunction:function(t,e){if(t)return t.name},editor:{type:"custom",component:w}};break;case"color":t.hide?delete this.settings.columns.color:this.settings.columns.color={width:"10%",title:nt.text_color,type:"html",valuePrepareFunction:function(t,e){if(t)return t.name},editor:{type:"custom",component:w}};break;case"design":t.hide?delete this.settings.columns.design:this.settings.columns.design={width:"10%",title:nt.text_design,type:"html",valuePrepareFunction:function(t,e){if(t)return t.name},editor:{type:"custom",component:w}};break;case"commisionAmount":t.hide?delete this.settings.columns.commisionAmount:this.settings.columns.commisionAmount={title:"Commission",type:"text",width:"8%",editor:{type:"custom",component:J}};break;case"receivedDiscount":t.hide?delete this.settings.columns.receivedDiscount:this.settings.columns.receivedDiscount={title:"Received disc.",type:"html",width:"8%",valuePrepareFunction:function(t,e){if(t)return t+(e.isReceivedDiscPercentage?"%":"")},editor:{type:"custom",component:M}}}this.settings=Object.assign({},this.settings)},t.prototype.ngOnInit=function(){this.setColumns()},t.prototype.getSuppliers=function(){return(0,s.mG)(this,void 0,void 0,function(){var t;return(0,s.Jh)(this,function(e){switch(e.label){case 0:return[4,this.apiService.get(this.urlHandler.url.supplier.get_suppliers)];case 1:return t=e.sent(),this.suppliers=t.body,[2]}})})},t.prototype.addNewItem=function(t){return(0,s.mG)(this,void 0,void 0,function(){var e,n,i,o=this;return(0,s.Jh)(this,function(r){switch(r.label){case 0:return(e=t.newData).product?(e.strip=e.strip?e.product.strip:1,e.piecesPerStrip=e.piecesPerStrip?e.product.piecesPerStrip:1,e.salesTax=e.product.salesTax,0==e.quantity||e.quantity<0?(this.utilCtrl.showToast("Please enter the quantity",this.utilCtrl.toastTypeArr.WARNING),t.confirm.reject(t.newData),[3,6]):[3,1]):(this.utilCtrl.showToast("Please enter product",this.utilCtrl.toastTypeArr.WARNING),[2,t.confirm.reject(t.newData)]);case 1:return e.retailPrice<=e.purchasePrice?(this.utilCtrl.showToast("Retail price should be greater than purchase price",this.utilCtrl.toastTypeArr.WARNING),t.confirm.reject(t.newData),[3,6]):[3,2];case 2:return t.newData=e,(n=e).brand||(n.brand=null),n.size||(n.size=null),n.design||(n.design=null),n.color||(n.color=null),n.barcode&&(n.autoBarcode=!1),n.purchasePriceWithoutDiscount||(n.purchasePriceWithoutDiscount=0),n.supplierBillId=this.supplierBillId,this.supplierBillId?[4,this.apiService.post(this.urlHandler.url.inventory.add_item,n)]:[3,4];case 3:return(i=r.sent()).success?t.confirm.resolve(i.body):this.utilCtrl.showToast("An error occurred while processing your request",this.utilCtrl.toastTypeArr.WARNING),[3,5];case 4:t.confirm.resolve(t.newData),r.label=5;case 5:setTimeout(function(){o.calculateTotalAmount()}),r.label=6;case 6:return[2]}})})},t.prototype.onSaveConfirm=function(t){return(0,s.mG)(this,void 0,void 0,function(){var e,n=this;return(0,s.Jh)(this,function(i){switch(i.label){case 0:return(e=t.newData).product?(e.strip=e.strip?e.product.strip:1,e.piecesPerStrip=e.piecesPerStrip?e.product.piecesPerStrip:1,e.salesTax=e.product.salesTax,t.newData=e,0==e.quantity||e.quantity<0?(this.utilCtrl.showToast("Please enter the quantity",this.utilCtrl.toastTypeArr.WARNING),t.confirm.reject(t.newData),[3,6]):[3,1]):(this.utilCtrl.showToast("Please enter product",this.utilCtrl.toastTypeArr.WARNING),[2,t.confirm.reject(t.newData)]);case 1:return e.retailPrice<=e.purchasePrice?(this.utilCtrl.showToast("Retail price should be greater than purchase price",this.utilCtrl.toastTypeArr.WARNING),t.confirm.reject(t.newData),[3,6]):[3,2];case 2:return t.data._id?[4,this.apiService.post(this.urlHandler.url.inventory.update_item+"?supplierBillId="+this.supplierBillId,e)]:[3,4];case 3:return i.sent().success?(this.inventories=t.source.data,t.confirm.resolve(t.newData)):this.utilCtrl.showToast("An error occurred while processing your request",this.utilCtrl.toastTypeArr.WARNING),[3,5];case 4:t.newData.exRetailSalesTax=this.model.exRetailSalesTax,t.newData.isReceivedDiscPercentage=this.model.isReceivedDiscPercentage,this.inventories=(0,s.ev)([],(0,s.CR)(this.inventories)),t.confirm.resolve(t.newData),i.label=5;case 5:setTimeout(function(){n.calculateTotalAmount(),n.model=new a},100),i.label=6;case 6:return[2]}})})},t.prototype.onDeleteConfirm=function(t){return(0,s.mG)(this,void 0,void 0,function(){var e,n=this;return(0,s.Jh)(this,function(i){switch(i.label){case 0:return window.confirm("Are you sure you want to delete?")?(e=t.data._id)?[4,this.apiService.delete(this.urlHandler.url.inventory.delete_item+e+"&supplierBillId="+this.supplierBillId)]:[3,2]:[3,4];case 1:return i.sent().success?t.confirm.resolve():this.utilCtrl.showToast("An error occurred while processing your request",this.utilCtrl.toastTypeArr.WARNING),[3,3];case 2:t.confirm.resolve(),i.label=3;case 3:return[3,5];case 4:t.confirm.reject(),i.label=5;case 5:return setTimeout(function(){n.inventories=t.source.data,n.calculateTotalAmount()},100),[2]}})})},t.prototype.calculateTotalAmount=function(){var t=this;this.inventoryBill.totalRetailPrice=0,this.inventoryBill.totalPurchasePrice=0,this.inventories.forEach(function(e){t.inventoryBill.totalRetailPrice+=e.retailPrice*e.quantity,t.inventoryBill.totalPurchasePrice+=e.purchasePrice*e.quantity})},t.prototype.reset=function(){this.supplierBillId=null,this.model=new a,this.inventoryBill=new c,this.inventories=[],this.selectedRows=[],this.selectedSupplierName=null,this.settings.selectMode=null,this.settings=Object.assign({},this.settings)},t.prototype.save=function(t){var e=this;if(void 0===t&&(t=null),this.inventories.length){this.inventories.forEach(function(t){e.inventoryBill.totalQuantity+=t.quantity,t.brand||(t.brand=null),t.size||(t.size=null),t.design||(t.design=null),t.color||(t.color=null),t.barcode&&(t.autoBarcode=!1),t.purchasePriceWithoutDiscount||(t.purchasePriceWithoutDiscount=0)});var n=null;this.supplierBillId?(n=this.urlHandler.url.inventory.update_supplier_bill,this.inventoryBill._id=this.supplierBillId):n=this.urlHandler.url.inventory.create,this.inventoryBill.inventories=this.inventories,this.apiService.post(n,this.inventoryBill).then(function(t){t.success?(e.supplierBillId||(e.supplierBillId=t.body._id,e.inventories=t.body.inventories,e.settings.selectMode="multi",e.settings=Object.assign({},e.settings)),e.utilCtrl.showToast(nt[t.message],e.utilCtrl.toastTypeArr.SUCCESS)):e.utilCtrl.showToast(nt[t.message],e.utilCtrl.toastTypeArr.DANGER)},function(t){return console.log(t)})}},t.prototype.onRowSelect=function(t){this.selectedRows=t.selected,console.log(t)},t.prototype.printBarcode=function(){if(this.selectedRows.length){this.barcodePrintList=[];for(var t=0;t<this.selectedRows.length;t++)for(var e=0;e<this.selectedRows[t].quantity;e++)this.barcodePrintList.push(this.selectedRows[t]);this.printService.onDataReady()}else this.utilCtrl.showToast("Please select item to print",this.utilCtrl.toastTypeArr.WARNING)},t.prototype.onAddPopupClose=function(t){this.showPopup=!1,this.selectedProduct=new u.x},t.prototype.onIsNewBarcode=function(){this.events.publish("onIsNewBarcode",this.isNewBarcode),localStorage.setItem("isNewBarcode",JSON.stringify(this.isNewBarcode))},t.prototype.searchProductByBarcode=function(){return(0,s.mG)(this,void 0,void 0,function(){var t,e;return(0,s.Jh)(this,function(n){switch(n.label){case 0:return this.searchQuery?[4,this.apiService.get(this.urlHandler.url.inventory.search_inventory_item_by_barcode+"?searchBy="+p.Qv.Barcode+"&barcode="+this.searchQuery)]:[2,this.utilCtrl.showToast("Please enter barcode",this.utilCtrl.toastTypeArr.WARNING)];case 1:if(t=n.sent(),e=t.body){if(this.inventories.find(function(t){return t.barcode==e.barcode}))return[2,this.utilCtrl.showToast("This record already added",this.utilCtrl.toastTypeArr.WARNING)];this.searchQuery=null,delete e._id,e.quantity=0,e.commisionAmount=0,console.log(e),this.inventories.unshift(e),this.inventories=(0,s.ev)([],(0,s.CR)(this.inventories))}else this.utilCtrl.showToast("Record not found",this.utilCtrl.toastTypeArr.WARNING);return[2]}})})},t.\u0275fac=function(e){return new(e||t)(m.Y36(v.s),m.Y36(Z.z),m.Y36(N.sk),m.Y36(i.uU),m.Y36(U.b),m.Y36(f.a),m.Y36(p.v_),m.Y36(D),m.Y36(T.n),m.Y36(m.sBO),m.Y36(y.Jh),m.Y36(o.gz))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-create-inventory"]],decls:87,vars:57,consts:[[1,"container-fluid"],[1,"row","justify-content-center"],[1,"col-12","col-sm-12","col-md-12","col-lg-12","col-xl-12","p-0","mt-3","mb-2"],[1,"row"],[1,"col-md-12"],["novalidate","",1,"needs-validation","user-add","text-left"],["f","ngForm"],[1,"table"],["scope","col"],["for","name"],[3,"ngModelOptions","placeholder","ngModel","datasource","minSearchLength","focus","selected","ngModelChange"],["for",""],["type","text","id","billNo","name","billNo",1,"form-control",3,"ngModel","ngModelChange"],["billNo","ngModel"],["type","text","id","shipping","name","shipping",1,"form-control",3,"ngModel","ngModelChange"],["shipping","ngModel"],[1,"m-0","pull-right"],["name","isDiscountPercentage","type","checkbox",2,"width","fit-content",3,"ngModel","ngModelChange"],["isDiscountPercentage","ngModel"],["type","text","id","discount","name","discount",1,"form-control",3,"ngModel","ngModelChange"],["discount","ngModel"],["type","button",1,"btn","btn-primary","pull-right","mt-4",3,"click"],[1,"col-md-6"],["class","popup pull-left",3,"click",4,"ngIf"],[1,"form-group","col-3","pull-left"],[1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn-primary","pull-left","btn-sm","p-1",3,"disabled","click"],[1,"btn-primary","pull-left","btn-sm","ml-2",3,"click"],[1,"fa","fa-refresh"],["name","isNewBarcode","type","checkbox",2,"width","fit-content",3,"ngModel","change","ngModelChange"],[1,"btn-primary","btn-sm","ml-2",3,"click"],[1,"col-md-2"],["type","text","id","searchQuery","placeholder","Search barcode","name","searchQuery",1,"form-control",3,"ngModel","keyup.enter","ngModelChange"],[1,"mb-0","text-center"],[1,"counter"],[1,"m-0",2,"font-weight","500"],[3,"settings","source","onRowSelect","editConfirm","deleteConfirm","createConfirm"],[3,"defaultPrinter","barcodePrintList"],[3,"model","showPopup","onPopupClose"],[1,"popup","pull-left",3,"click"],["id","myPopup",1,"popuptext"],[2,"width","100%"],[4,"ngFor","ngForOf"],[2,"text-align","left","padding","5px"],[2,"cursor","pointer","display","block","margin-bottom","0",3,"change"],["type","checkbox",2,"margin-bottom","0","width","auto",3,"checked"],[3,"value"]],template:function(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"div",4),m.TgZ(5,"form",5,6),m.TgZ(7,"table",7),m.TgZ(8,"tbody"),m.TgZ(9,"tr"),m.TgZ(10,"th",8),m.TgZ(11,"label",9),m._uU(12),m.ALo(13,"i18n"),m.TgZ(14,"span"),m._uU(15,"*"),m.qZA(),m.qZA(),m.TgZ(16,"ng2-completer",10),m.NdJ("focus",function(){return e.focus()})("selected",function(t){return e.onSupplierSelected(t)})("ngModelChange",function(t){return e.selectedSupplierName=t}),m.ALo(17,"i18n"),m.qZA(),m.qZA(),m.TgZ(18,"th",8),m.TgZ(19,"label",11),m._uU(20),m.ALo(21,"i18n"),m.qZA(),m.TgZ(22,"input",12,13),m.NdJ("ngModelChange",function(t){return e.inventoryBill.billNo=t}),m.qZA(),m.qZA(),m.TgZ(24,"th",8),m.TgZ(25,"label",11),m._uU(26),m.ALo(27,"i18n"),m.qZA(),m.TgZ(28,"input",14,15),m.NdJ("ngModelChange",function(t){return e.inventoryBill.shipping=t}),m.qZA(),m.qZA(),m.TgZ(30,"th",8),m.TgZ(31,"label",11),m._uU(32),m.ALo(33,"i18n"),m.qZA(),m.TgZ(34,"span"),m.TgZ(35,"label",16),m.TgZ(36,"input",17,18),m.NdJ("ngModelChange",function(t){return e.inventoryBill.isDiscountPercentage=t}),m.qZA(),m._uU(38," % "),m.qZA(),m.qZA(),m.TgZ(39,"input",19,20),m.NdJ("ngModelChange",function(t){return e.inventoryBill.discount=t}),m.qZA(),m.qZA(),m.TgZ(41,"th",8),m.TgZ(42,"button",21),m.NdJ("click",function(){m.CHM(n);var t=m.MAs(6);return t.valid&&e.save(t)}),m._uU(43),m.ALo(44,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(45,"div",3),m.TgZ(46,"div",22),m.YNc(47,$,6,1,"div",23),m.TgZ(48,"div",24),m.TgZ(49,"select",25),m.NdJ("ngModelChange",function(t){return e.defaultPrinter=t}),m.TgZ(50,"option"),m._uU(51),m.ALo(52,"i18n"),m.qZA(),m.YNc(53,tt,2,2,"option",26),m.qZA(),m.qZA(),m.TgZ(54,"button",27),m.NdJ("click",function(){return e.printBarcode()}),m._uU(55),m.ALo(56,"i18n"),m.qZA(),m.TgZ(57,"button",28),m.NdJ("click",function(){return e.reset()}),m._UZ(58,"i",29),m.qZA(),m.TgZ(59,"label",16),m.TgZ(60,"input",30),m.NdJ("change",function(){return e.onIsNewBarcode()})("ngModelChange",function(t){return e.isNewBarcode=t}),m.qZA(),m._uU(61," Custom Barcode "),m.qZA(),m.TgZ(62,"button",31),m.NdJ("click",function(){return e.showPopup=!0}),m._uU(63,"Add Product"),m.qZA(),m.qZA(),m.TgZ(64,"div",32),m.TgZ(65,"input",33),m.NdJ("keyup.enter",function(){return e.searchProductByBarcode()})("ngModelChange",function(t){return e.searchQuery=t}),m.qZA(),m.qZA(),m.TgZ(66,"div",32),m.TgZ(67,"h4",34),m.TgZ(68,"span",35),m._uU(69),m.ALo(70,"round"),m.qZA(),m._UZ(71,"br"),m.TgZ(72,"small",36),m._uU(73),m.ALo(74,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(75,"div",32),m.TgZ(76,"h4",34),m.TgZ(77,"span",35),m._uU(78),m.ALo(79,"round"),m.qZA(),m._UZ(80,"br"),m.TgZ(81,"small",36),m._uU(82),m.ALo(83,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(84,"ng2-smart-table",37),m.NdJ("onRowSelect",function(t){return e.onRowSelect(t)})("editConfirm",function(t){return e.onSaveConfirm(t)})("deleteConfirm",function(t){return e.onDeleteConfirm(t)})("createConfirm",function(t){return e.addNewItem(t)}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m._UZ(85,"app-print-barcode",38),m.TgZ(86,"app-add-product",39),m.NdJ("onPopupClose",function(t){return e.onAddPopupClose(t)}),m.qZA()}2&t&&(m.xp6(12),m.hij("",m.lcZ(13,32,"text_supplier")," "),m.xp6(4),m.Q6J("ngModelOptions",m.DdM(56,et))("placeholder",m.lcZ(17,34,"text_search"))("ngModel",e.selectedSupplierName)("datasource",e.dataService)("minSearchLength",0),m.xp6(4),m.Oqu(m.lcZ(21,36,"text_bill")),m.xp6(2),m.Q6J("ngModel",e.inventoryBill.billNo),m.xp6(4),m.Oqu(m.lcZ(27,38,"text_shipping")),m.xp6(2),m.Q6J("ngModel",e.inventoryBill.shipping),m.xp6(4),m.Oqu(m.lcZ(33,40,"text_discount")),m.xp6(4),m.Q6J("ngModel",e.inventoryBill.isDiscountPercentage),m.xp6(3),m.Q6J("ngModel",e.inventoryBill.discount),m.xp6(4),m.hij("",m.lcZ(44,42,"text_save")," "),m.xp6(4),m.Q6J("ngIf",e.columns.length),m.xp6(2),m.Q6J("ngModel",e.defaultPrinter),m.xp6(2),m.Oqu(m.lcZ(52,44,"text_tagsPerRow")),m.xp6(2),m.Q6J("ngForOf",e.barcodeSettings),m.xp6(1),m.Q6J("disabled",!e.inventories.length),m.xp6(1),m.hij("",m.lcZ(56,46,"text_printBarcode")," "),m.xp6(5),m.Q6J("ngModel",e.isNewBarcode),m.xp6(5),m.Q6J("ngModel",e.searchQuery),m.xp6(4),m.Oqu((null==e.user||null==e.user.company||null==e.user.company.country?null:e.user.company.country.currency.symbol)+" "+m.lcZ(70,48,null==e.inventoryBill?null:e.inventoryBill.totalPurchasePrice)),m.xp6(4),m.hij("",m.lcZ(74,50,"text_totalPurchase")," "),m.xp6(5),m.Oqu((null==e.user||null==e.user.company||null==e.user.company.country?null:e.user.company.country.currency.symbol)+" "+m.lcZ(79,52,null==e.inventoryBill?null:e.inventoryBill.totalRetailPrice)),m.xp6(4),m.hij("",m.lcZ(83,54,"text_totalRetail")," "),m.xp6(2),m.Q6J("settings",e.settings)("source",e.inventories),m.xp6(1),m.Q6J("defaultPrinter",e.defaultPrinter)("barcodePrintList",e.barcodePrintList),m.xp6(1),m.Q6J("model",e.selectedProduct)("showPopup",e.showPopup))},directives:[b._Y,b.JL,b.F,y.nl,b.JJ,b.On,b.Fj,b.Wl,i.O5,b.EJ,b.YN,b.Kr,i.sg,h.T5,V,W.e],pipes:[A.X,K.L],styles:['.lt-ie9[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{line-height:26px}.profile-pic[_ngcontent-%COMP%]{position:relative;display:inline-block}.profile-pic[_ngcontent-%COMP%]:hover   .edit[_ngcontent-%COMP%]{display:block}.edit[_ngcontent-%COMP%]{display:none}.edit[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#000}.price[_ngcontent-%COMP%]{border:none;width:54px;text-align:center}.img-br[_ngcontent-%COMP%]{border-radius:50px}  ng2-smart-table table .ng2-smart-action{font-size:inherit}  ng2-smart-table table .ng2-smart-titles .ng2-smart-th{padding:0!important}  ng2-smart-table table tr th{font-size:.74em;padding:0!important}  .completer-input{width:100%}  .needs-validation input{padding:7px!important}  ng2-smart-table table tr td{padding:0!important}.popup[_ngcontent-%COMP%]{position:relative;display:inline-block;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none}.popup[_ngcontent-%COMP%]   .popuptext[_ngcontent-%COMP%]{display:none;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;background-color:#e2e0e0;text-align:center;border-radius:6px;padding:8px 0;position:absolute;z-index:1;top:135%;left:73%;margin-left:-80px}.popup[_ngcontent-%COMP%]   .popuptext[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:100%;left:50%;margin-left:-5px;border:5px solid transparent;border-bottom-color:#555}.popup[_ngcontent-%COMP%]   .show[_ngcontent-%COMP%]{display:block;-webkit-animation:fadeIn 1s;animation:fadeIn 1s}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}']}),t}(),ot=n(57750),rt=["modalContent"],lt=function(t){return{"is-invalid":t}};function st(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"div",1),m.TgZ(1,"h5",2),m._uU(2,"Barcode Print "),m.qZA(),m.TgZ(3,"button",3),m.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),m.TgZ(4,"span",4),m._uU(5,"\xd7"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(6,"form",5,6),m.NdJ("ngSubmit",function(){m.CHM(n);var t=m.MAs(7),e=m.oxw();return t.valid&&e.print()}),m.TgZ(8,"div",7),m.TgZ(9,"div",8),m.TgZ(10,"div",9),m.TgZ(11,"label",10),m.TgZ(12,"span"),m._uU(13,"*"),m.qZA(),m._uU(14),m.ALo(15,"i18n"),m.qZA(),m.TgZ(16,"input",11,12),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().model.quantity=t}),m.qZA(),m.TgZ(18,"div",13),m._uU(19," This field is required "),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(20,"div",14),m.TgZ(21,"button",15),m.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),m._uU(22),m.ALo(23,"i18n"),m.qZA(),m.TgZ(24,"button",16),m._uU(25),m.ALo(26,"i18n"),m.qZA(),m.qZA(),m.qZA()}if(2&t){var i=m.MAs(7),o=m.MAs(17),r=m.oxw();m.xp6(14),m.hij(" ",m.lcZ(15,5,"text_qty"),""),m.xp6(2),m.Q6J("ngModel",r.model.quantity)("ngClass",m.VKq(11,lt,i.submitted&&o.invalid)),m.xp6(6),m.Oqu(m.lcZ(23,7,"text_close")),m.xp6(3),m.Oqu(m.lcZ(26,9,"text_print"))}}var at=function(){function t(t,e,n,i,o,r,l){this.formBuilder=t,this.modalService=e,this.commonService=n,this.apiService=i,this.urlHandler=o,this.utilCtrl=r,this.printService=l,this.onPrintDialogClose=new m.vpe,this.onPrint=new m.vpe,this.apiURL=g.N.apiUrl,this.barcodePrintList=[]}return t.prototype.ngOnChanges=function(){var t=this;this.showPopup&&this.modalService.open(this.modalContent,{ariaLabelledBy:"modal-basic-title"}).result.then(function(t){console.log("Closed with")},function(e){t.onPrintDialogClose.emit(e),console.log(e)})},t.prototype.print=function(){this.onPrint.emit(this.model),this.modalService.dismissAll()},t.prototype.ngOnInit=function(){},t.\u0275fac=function(e){return new(e||t)(m.Y36(b.qu),m.Y36(ot.FF),m.Y36(p.v_),m.Y36(v.s),m.Y36(Z.z),m.Y36(U.b),m.Y36(D))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-barcode-dialog"]],viewQuery:function(t,e){var n;1&t&&m.Gf(rt,7),2&t&&m.iGM(n=m.CRH())&&(e.modalContent=n.first)},inputs:{showPopup:"showPopup",model:"model"},outputs:{onPrintDialogClose:"onPrintDialogClose",onPrint:"onPrint"},features:[m.TTD],decls:2,vars:0,consts:[["modalContent",""],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","f-w-600"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["novalidate","",1,"needs-validation","user-add",3,"ngSubmit"],["f","ngForm"],[1,"modal-body"],[1,"form-row"],[1,"form-group","col-md-12"],["for","quantity"],["id","quantity","name","quantity","type","number","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["quantity","ngModel"],[1,"invalid-feedback"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-light",3,"click"],["type","submit",1,"btn","btn-primary"]],template:function(t,e){1&t&&m.YNc(0,st,27,13,"ng-template",null,0,m.W1O)},directives:[b._Y,b.JL,b.F,b.wV,b.Fj,b.Q7,b.JJ,b.On,i.mk],pipes:[A.X],styles:[".full[_ngcontent-%COMP%]{width:100%}.contact-list-container[_ngcontent-%COMP%]{background-color:#fff;padding:10px}.contact-list-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]{height:400px;overflow:auto}.contact-list-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .contact-list-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .contact-list-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.contact-list-container[_ngcontent-%COMP%]   .contact-list[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%}.contact-list-container[_ngcontent-%COMP%]   .contact-list-header[_ngcontent-%COMP%]{background-color:#eee;padding:10px}.contact-list-container[_ngcontent-%COMP%]   .contact-list-header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:auto}.contact-add[_ngcontent-%COMP%]{padding:10px;background:#fff}.contact-add[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%}.contact-add[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:auto}.avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%}"]}),t}(),ct=function(){function t(t,e){this.printService=t,this.events=e,this.model={},this.save=new m.vpe,this.barcodePrintList=[]}return t.prototype.ngOnInit=function(){},t.prototype.openDetails=function(){this.showPopup=!0},t.prototype.onPrintDialogClose=function(t){this.showPopup=!1},t.prototype.onPrint=function(t){this.events.publish("onPrint",t),this.save.emit(t)},t.\u0275fac=function(e){return new(e||t)(m.Y36(D),m.Y36(T.n))},t.\u0275cmp=m.Xpm({type:t,selectors:[["ng-component"]],inputs:{value:"value",rowData:"rowData"},outputs:{save:"save"},decls:3,vars:2,consts:[[1,"btn","btn-primary","btn","btn-primary","btn-small","p-1","text-white",3,"click"],[3,"model","showPopup","onPrint","onPrintDialogClose"]],template:function(t,e){1&t&&(m.TgZ(0,"button",0),m.NdJ("click",function(){return e.openDetails()}),m._uU(1,"Print"),m.qZA(),m.TgZ(2,"app-barcode-dialog",1),m.NdJ("onPrint",function(t){return e.onPrint(t)})("onPrintDialogClose",function(t){return e.onPrintDialogClose(t)}),m.qZA()),2&t&&(m.xp6(2),m.Q6J("model",e.value)("showPopup",e.showPopup))},directives:[at],encapsulation:2}),t}(),ut=n(6711),dt=function(t){return{"is-invalid":t}},pt=(JSON.parse(localStorage.getItem("lang")),function(){function t(t,e,n,i,o,r,l,s,a,c){var u=this;this.apiService=t,this.urlHandler=e,this.utilCtrl=n,this.socket=i,this.datePipe=o,this.parserFormatter=r,this.authGuard=l,this.commonService=s,this.events=a,this.printService=c,this.apiURL=g.N.apiUrl,this.settings={actions:{position:"right",add:!1,edit:!1,delete:!1},mode:"external",add:{confirmCreate:!0},delete:{confirmDelete:!1},columns:{product:{title:"Product",type:"html",valuePrepareFunction:function(t,e){return t.name}},quantity:{title:"Quantity",type:"html"},purchasePrice:{title:"Purchase price",type:"html",valuePrepareFunction:function(t,e){return u.user.company.country.currency.symbol+" "+t}},retailPrice:{title:"Retail price",type:"html",valuePrepareFunction:function(t,e){return u.user.company.country.currency.symbol+" "+t}}}},this.inventories=[],this.user=new d.n,this.barcodePrintList=[],this.selectedRows=[],this.user=this.authGuard.getLoggedInUser();var p=new Date,h={day:p.getDate(),month:p.getMonth()+1,year:p.getFullYear()};this.startDate=h,this.endDate={day:p.getDate(),month:p.getMonth()+1,year:p.getFullYear()},this.events.subscribe("onPrint",function(t){u.barcodePrintList=[];for(var e=0;e<t.quantity;e++){var n=t;n.product_doc=n.product,n.size_doc=n.size,n.brand_doc=n.brand,n.color_doc=n.color,n.design_doc=n.design,u.barcodePrintList.push(n)}u.printService.onDataReady()}),this.socketEvents(),this.setColumns()}return t.prototype.setColumns=function(){this.commonService.checkFeatureAllowed(l.AN.Brand)&&(this.settings.columns.brand={title:"Brand",type:"html",valuePrepareFunction:function(t,e){if(t)return t.name}}),this.commonService.checkFeatureAllowed(l.AN.Size)&&(this.settings.columns.size={title:"Size",type:"html",valuePrepareFunction:function(t,e){if(t)return t.name}}),this.commonService.checkFeatureAllowed(l.AN.Design)&&(this.settings.columns.design={title:"Design",type:"html",valuePrepareFunction:function(t,e){if(t)return t.name}}),this.commonService.checkFeatureAllowed(l.AN.Color)&&(this.settings.columns.color={title:"Color",type:"html",valuePrepareFunction:function(t,e){if(t)return t.name}}),this.settings.columns.barcode={filter:!1,title:"Barcode",type:"custom",valuePrepareFunction:function(t,e){return e},renderComponent:ct,onComponentInitFunction:function(t){t.save.subscribe(function(t){})}}},t.prototype.socketEvents=function(){var t=this;this.socket.on("inventory_bill_created",function(e){t.inventories.unshift(e.inventories),t.inventories=(0,s.ev)([],(0,s.CR)(t.inventories)),t.totalAmount=t.totalAmount+e.amount}),this.socket.on("inventory_item_deleted",function(e){var n=t.inventories.findIndex(function(t){return t._id==e._id});t.inventories.splice(n,1),t.inventories=(0,s.ev)([],(0,s.CR)(t.inventories))})},t.prototype.ngOnInit=function(){this.getData()},t.prototype.getData=function(){return(0,s.mG)(this,void 0,void 0,function(){var t,e,n;return(0,s.Jh)(this,function(i){switch(i.label){case 0:return t=this.parserFormatter.format(this.startDate),e=this.parserFormatter.format(this.endDate),[4,this.apiService.get(this.urlHandler.url.inventory.get_inventories+"?startDate="+t+"&endDate="+e)];case 1:return n=i.sent(),this.inventories=n.body,console.log(n),this.getTotalAmount(),[2]}})})},t.prototype.getTotalAmount=function(){return(0,s.mG)(this,void 0,void 0,function(){var t,e,n;return(0,s.Jh)(this,function(i){switch(i.label){case 0:return t=this.parserFormatter.format(this.startDate),e=this.parserFormatter.format(this.endDate),[4,this.apiService.get(this.urlHandler.url.inventory.get_inventories_total_amount+"?startDate="+t+"&endDate="+e)];case 1:return n=i.sent(),this.totalAmount=n.body,[2]}})})},t.prototype.delete=function(t){this.showDeletePopup=!0,this.deleteURL=this.urlHandler.url.inventory.delete_item+t.data._id},t.prototype.printBarcode=function(){if(this.selectedRows.length){this.barcodePrintList=[];for(var t=0;t<this.selectedRows.length;t++)for(var e=0;e<this.selectedRows[t].quantity;e++){var n=this.selectedRows[t];n.product_doc=n.product,n.size_doc=n.size,n.brand_doc=n.brand,n.color_doc=n.color,n.design_doc=n.design,this.barcodePrintList.push(n)}this.printService.onDataReady()}else this.utilCtrl.showToast("Please select item to print",this.utilCtrl.toastTypeArr.WARNING)},t.\u0275fac=function(e){return new(e||t)(m.Y36(v.s),m.Y36(Z.z),m.Y36(U.b),m.Y36(N.sk),m.Y36(i.uU),m.Y36(ot.NG),m.Y36(f.a),m.Y36(p.v_),m.Y36(T.n),m.Y36(D))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-inventory-list"]],decls:68,vars:40,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header"],[1,"row"],["novalidate","",1,"col-md-6","row",3,"ngSubmit"],["f","ngForm"],[1,"form-group","col-md-4","pr-0"],[1,"col-xl-12","col-md-12","pl-0"],[1,"input-group"],["type","text","id","inputStartDate","name","inputStartDate","ngbDatepicker","","required","",1,"form-control","p-2",3,"ngModel","ngClass","ngModelChange"],["d1","ngbDatepicker","inputStartDate","ngModel"],[1,"input-group-append"],[1,"input-group-text",3,"click"],[1,"fa","fa-calendar",2,"cursor","pointer"],[1,"invalid-feedback"],["type","text","id","inputEndDate","name","inputEndDate","ngbDatepicker","","required","",1,"form-control","p-2",3,"ngModel","ngClass","ngModelChange"],["d2","ngbDatepicker","inputEndDate","ngModel"],[1,"form-group","col-md-2"],["type","submit",1,"btn","btn-primary","mt-4"],[1,"col-xl-3","col-md-3"],[1,"card","o-hidden","widget-cards","mb-0"],[1,"bg-primary","card-body","p-2","text-center"],[1,"media","static-top-widget","row"],[1,"media-body"],[1,"m-0"],[1,"mb-0"],[1,"counter"],[1,"card-body","vendor-table","pt-0"],["id","batchDelete",1,"custom-datatable","vendor-list"],[1,"table-responsive"],[3,"settings","source","delete"],[3,"deleteURL","showPopup","onPopupClose"],[3,"barcodePrintList"]],template:function(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"form",4,5),m.NdJ("ngSubmit",function(){return m.CHM(n),m.MAs(5).form.valid&&e.getData()}),m.TgZ(6,"div",6),m.TgZ(7,"label",7),m._uU(8),m.ALo(9,"i18n"),m.qZA(),m.TgZ(10,"div",8),m.TgZ(11,"input",9,10),m.NdJ("ngModelChange",function(t){return e.startDate=t}),m.qZA(),m.TgZ(14,"div",11),m.TgZ(15,"div",12),m.NdJ("click",function(){return m.CHM(n),m.MAs(12).toggle()}),m._UZ(16,"i",13),m.qZA(),m.qZA(),m.TgZ(17,"div",14),m._uU(18),m.ALo(19,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(20,"div",6),m.TgZ(21,"label",7),m._uU(22),m.ALo(23,"i18n"),m.qZA(),m.TgZ(24,"div",8),m.TgZ(25,"input",15,16),m.NdJ("ngModelChange",function(t){return e.endDate=t}),m.qZA(),m.TgZ(28,"div",11),m.TgZ(29,"div",12),m.NdJ("click",function(){return m.CHM(n),m.MAs(26).toggle()}),m._UZ(30,"i",13),m.qZA(),m.qZA(),m.TgZ(31,"div",14),m._uU(32),m.ALo(33,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(34,"div",17),m.TgZ(35,"button",18),m._uU(36),m.ALo(37,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(38,"div",19),m.TgZ(39,"div",20),m.TgZ(40,"div",21),m.TgZ(41,"div",22),m.TgZ(42,"div",23),m.TgZ(43,"span",24),m._uU(44),m.ALo(45,"i18n"),m.qZA(),m.TgZ(46,"h3",25),m.TgZ(47,"span",26),m._uU(48),m.ALo(49,"round"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(50,"div",19),m.TgZ(51,"div",20),m.TgZ(52,"div",21),m.TgZ(53,"div",22),m.TgZ(54,"div",23),m.TgZ(55,"span",24),m._uU(56),m.ALo(57,"i18n"),m.qZA(),m.TgZ(58,"h3",25),m.TgZ(59,"span",26),m._uU(60),m.ALo(61,"round"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(62,"div",27),m.TgZ(63,"div",28),m.TgZ(64,"div",29),m.TgZ(65,"ng2-smart-table",30),m.NdJ("delete",function(t){return e.delete(t)}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(66,"app-delete-record",31),m.NdJ("onPopupClose",function(){return e.showDeletePopup=!1}),m.qZA(),m._UZ(67,"app-print-barcode",32)}if(2&t){var i=m.MAs(5),o=m.MAs(13),r=m.MAs(27);m.xp6(8),m.Oqu(m.lcZ(9,18,"text_startDate")),m.xp6(3),m.Q6J("ngModel",e.startDate)("ngClass",m.VKq(36,dt,i.submitted&&o.invalid)),m.xp6(7),m.hij(" ",m.lcZ(19,20,"text_startDate")," "),m.xp6(4),m.Oqu(m.lcZ(23,22,"text_endDate")),m.xp6(3),m.Q6J("ngModel",e.endDate)("ngClass",m.VKq(38,dt,i.submitted&&r.invalid)),m.xp6(7),m.hij(" ",m.lcZ(33,24,"text_endDate")," "),m.xp6(4),m.Oqu(m.lcZ(37,26,"text_search")),m.xp6(8),m.hij("",m.lcZ(45,28,"text_purchasePrice")," "),m.xp6(4),m.Oqu((null==e.user||null==e.user.company||null==e.user.company.country?null:e.user.company.country.currency.symbol)+" "+m.lcZ(49,30,null==e.totalAmount?null:e.totalAmount.purchase)),m.xp6(8),m.hij(" ",m.lcZ(57,32,"text_retailPrice")," "),m.xp6(4),m.Oqu((null==e.user||null==e.user.company||null==e.user.company.country?null:e.user.company.country.currency.symbol)+" "+m.lcZ(61,34,null==e.totalAmount?null:e.totalAmount.retail)),m.xp6(5),m.Q6J("settings",e.settings)("source",e.inventories),m.xp6(1),m.Q6J("deleteURL",e.deleteURL)("showPopup",e.showDeletePopup),m.xp6(1),m.Q6J("barcodePrintList",e.barcodePrintList)}},directives:[b._Y,b.JL,b.F,ot.J4,b.Fj,b.Q7,b.JJ,b.On,i.mk,h.T5,ut.c,V],pipes:[A.X,K.L],styles:[""]}),t}()),gt=n(43980),ht=n(82589),mt=n(59814),ft=n(18185),vt=["modalContent"],Zt=function(t){return{"is-invalid":t}};function yt(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"div",1),m.TgZ(1,"h5",2),m._uU(2),m.qZA(),m.TgZ(3,"button",3),m.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),m.TgZ(4,"span",4),m._uU(5,"\xd7"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(6,"form",5,6),m.TgZ(8,"div",7),m.TgZ(9,"div",8),m.TgZ(10,"div",9),m.TgZ(11,"label",10),m.TgZ(12,"span"),m._uU(13,"*"),m.qZA(),m._uU(14),m.ALo(15,"i18n"),m.qZA(),m.TgZ(16,"input",11,12),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().model.purchasePrice=t}),m.qZA(),m.TgZ(18,"div",13),m._uU(19),m.ALo(20,"i18n"),m.qZA(),m.qZA(),m.TgZ(21,"div",9),m.TgZ(22,"label",14),m.TgZ(23,"span"),m._uU(24,"*"),m.qZA(),m._uU(25),m.ALo(26,"i18n"),m.TgZ(27,"label"),m.TgZ(28,"input",15,16),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().model.exRetailSalesTax=t}),m.qZA(),m._uU(30," (Ex. GST) "),m.qZA(),m._uU(31),m.qZA(),m.TgZ(32,"input",17,18),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().model.retailPrice=t}),m.qZA(),m.TgZ(34,"div",13),m._uU(35),m.ALo(36,"i18n"),m.qZA(),m.qZA(),m.TgZ(37,"div",8),m.TgZ(38,"div",9),m.TgZ(39,"label"),m._uU(40),m.ALo(41,"i18n"),m.qZA(),m.TgZ(42,"input",19,20),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().model.barcode=t}),m.qZA(),m.qZA(),m.TgZ(44,"div",9),m.TgZ(45,"label",21),m._uU(46),m.ALo(47,"i18n"),m.qZA(),m.TgZ(48,"input",22,23),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().model.quantity=t}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(50,"div",24),m.TgZ(51,"button",25),m.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),m._uU(52),m.ALo(53,"i18n"),m.qZA(),m.TgZ(54,"button",26),m.NdJ("click",function(){m.CHM(n);var t=m.MAs(7);return m.oxw().save(t)}),m._uU(55),m.ALo(56,"i18n"),m.qZA(),m.qZA(),m.qZA()}if(2&t){var i=m.MAs(7),o=m.MAs(17),r=m.MAs(33),l=m.oxw();m.xp6(2),m.hij("",l.model._id?"Edit":"Add"," "),m.xp6(12),m.hij(" ",m.lcZ(15,17,"text_purchasePrice"),""),m.xp6(2),m.Q6J("ngModel",l.model.purchasePrice)("ngClass",m.VKq(33,Zt,i.submitted&&o.invalid)),m.xp6(3),m.hij(" ",m.lcZ(20,19,"text_thisFieldIsRequired")," "),m.xp6(6),m.hij(" ",m.lcZ(26,21,"text_retailPrice")," "),m.xp6(3),m.Q6J("ngModel",l.model.exRetailSalesTax),m.xp6(3),m.hij(" (",l.model.product.salesTax,"%)"),m.xp6(1),m.Q6J("ngModel",l.model.retailPrice)("ngClass",m.VKq(35,Zt,i.submitted&&r.invalid)),m.xp6(3),m.hij(" ",m.lcZ(36,23,"text_thisFieldIsRequired")," "),m.xp6(5),m.hij(" ",m.lcZ(41,25,"text_barcode")," "),m.xp6(2),m.Q6J("ngModel",l.model.barcode),m.xp6(4),m.hij(" ",m.lcZ(47,27,"text_quantity")," "),m.xp6(2),m.Q6J("ngModel",l.model.quantity),m.xp6(4),m.Oqu(m.lcZ(53,29,"text_close")),m.xp6(3),m.Oqu(m.lcZ(56,31,"text_save"))}}var bt=JSON.parse(localStorage.getItem("lang")),At=function(){function t(t,e,n,i,o,r,s){this.formBuilder=t,this.modalService=e,this.commonService=n,this.apiService=i,this.urlHandler=o,this.utilCtrl=r,this.authGuard=s,this.model=new a,this.onPopupClose=new m.vpe,this.apiURL=g.N.apiUrl,this.features=l.AN,this.user=new d.n,this.user=this.authGuard.getLoggedInUser()}return t.prototype.ngOnChanges=function(){var t=this;this.showPopup&&this.modalService.open(this.modalContent,{ariaLabelledBy:"modal-basic-title"}).result.then(function(t){console.log("Closed with")},function(e){t.onPopupClose.emit(e),console.log(e)})},t.prototype.ngOnInit=function(){},t.prototype.getRetailPriceAfterGST=function(t){this.model.retailPrice-=Math.ceil(this.model.retailPrice*this.model.product.salesTax/(100+this.model.product.salesTax))},t.prototype.save=function(t){var e,n=this;e=this.urlHandler.url.inventory.update_stock,this.model.exRetailSalesTax||(this.model.retailPrice-=Math.ceil(this.model.retailPrice*this.model.product.salesTax/(100+this.model.product.salesTax))),this.apiService.post(e,this.model).then(function(t){t.success?(n.utilCtrl.showToast(bt[t.message],n.utilCtrl.toastTypeArr.SUCCESS),n.modalService.dismissAll()):n.utilCtrl.showToast(bt[t.message],n.utilCtrl.toastTypeArr.DANGER)},function(t){return console.log(t)})},t.\u0275fac=function(e){return new(e||t)(m.Y36(b.qu),m.Y36(ot.FF),m.Y36(p.v_),m.Y36(v.s),m.Y36(Z.z),m.Y36(U.b),m.Y36(f.a))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-edit-stock"]],viewQuery:function(t,e){var n;1&t&&m.Gf(vt,7),2&t&&m.iGM(n=m.CRH())&&(e.modalContent=n.first)},inputs:{showPopup:"showPopup",model:"model"},outputs:{onPopupClose:"onPopupClose"},features:[m.TTD],decls:2,vars:0,consts:[["modalContent",""],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","f-w-600"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["novalidate","",1,"needs-validation","user-add"],["f","ngForm"],[1,"modal-body"],[1,"form-row"],[1,"form-group","col-md-6"],["for","purchasePrice"],["id","purchasePrice","name","purchasePrice","type","text","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["purchasePrice","ngModel"],[1,"invalid-feedback"],["for","retailPrice"],["name","exRetailSalesTax","type","checkbox",2,"width","fit-content",3,"ngModel","ngModelChange"],["exRetailSalesTax","ngModel"],["id","retailPrice","name","retailPrice","type","text","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["retailPrice","ngModel"],["type","text","name","barcode",1,"form-control",3,"ngModel","ngModelChange"],["barcode","ngModel"],[2,"width","100%"],["type","text","name","quantity",1,"form-control",3,"ngModel","ngModelChange"],["quantity","ngModel"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-light",3,"click"],[1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&m.YNc(0,yt,57,37,"ng-template",null,0,m.W1O)},directives:[b._Y,b.JL,b.F,b.Fj,b.Q7,b.JJ,b.On,i.mk,b.Wl],pipes:[A.X],styles:[""]}),t}(),wt=["modalContent"],Tt=function(t){return{"is-invalid":t}};function qt(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"div",28),m.TgZ(1,"h5",29),m._uU(2,"Package "),m.qZA(),m.TgZ(3,"button",30),m.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),m.TgZ(4,"span",31),m._uU(5,"\xd7"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(6,"form",32,33),m.TgZ(8,"div",34),m.TgZ(9,"div",35),m.TgZ(10,"div",35),m.TgZ(11,"div",36),m.TgZ(12,"label"),m._uU(13),m.ALo(14,"i18n"),m.qZA(),m.TgZ(15,"input",37,38),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().packageModel.barcode=t}),m.qZA(),m.qZA(),m.TgZ(17,"div",36),m.TgZ(18,"label"),m.TgZ(19,"span"),m._uU(20,"*"),m.qZA(),m._uU(21),m.ALo(22,"i18n"),m.qZA(),m.TgZ(23,"input",39,40),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().packageModel.quantity=t}),m.qZA(),m.TgZ(25,"div",41),m._uU(26),m.ALo(27,"i18n"),m.qZA(),m.qZA(),m.TgZ(28,"div",36),m.TgZ(29,"label",42),m.TgZ(30,"span"),m._uU(31,"*"),m.qZA(),m._uU(32),m.ALo(33,"i18n"),m.qZA(),m.TgZ(34,"input",43,44),m.NdJ("ngModelChange",function(t){return m.CHM(n),m.oxw().packageModel.price=t}),m.qZA(),m.TgZ(36,"div",41),m._uU(37),m.ALo(38,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(39,"div",45),m.TgZ(40,"button",46),m.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),m._uU(41),m.ALo(42,"i18n"),m.qZA(),m.TgZ(43,"button",47),m.NdJ("click",function(){return m.CHM(n),m.oxw().addPackage()}),m._uU(44),m.ALo(45,"i18n"),m.qZA(),m.qZA(),m.qZA()}if(2&t){var i=m.MAs(7),o=m.MAs(24),r=m.MAs(35),l=m.oxw();m.xp6(13),m.hij(" ",m.lcZ(14,12,"text_barcode")," "),m.xp6(2),m.Q6J("ngModel",l.packageModel.barcode),m.xp6(6),m.hij(" ",m.lcZ(22,14,"text_quantity")," "),m.xp6(2),m.Q6J("ngModel",l.packageModel.quantity)("ngClass",m.VKq(26,Tt,i.submitted&&o.invalid)),m.xp6(3),m.hij(" ",m.lcZ(27,16,"text_thisFieldIsRequired")," "),m.xp6(6),m.hij(" ",m.lcZ(33,18,"text_price"),""),m.xp6(2),m.Q6J("ngModel",l.packageModel.price)("ngClass",m.VKq(28,Tt,i.submitted&&r.invalid)),m.xp6(3),m.hij(" ",m.lcZ(38,20,"text_thisFieldIsRequired")," "),m.xp6(4),m.Oqu(m.lcZ(42,22,"text_close")),m.xp6(3),m.Oqu(m.lcZ(45,24,"text_save"))}}var xt=JSON.parse(localStorage.getItem("lang")),Ct=function(){function t(t,e,n,i,o,r,l){this.apiService=t,this.urlHandler=e,this.authGuard=n,this.spinner=i,this.dbService=o,this.modalService=r,this.utilCtrl=l,this.apiURL=g.N.apiUrl,this.user=new d.n,this.config={enableActions:{edit:!0},enableCheck:!1,showLoading:!0,paging:{perPage:[10,50,100,500]},enablePagingWithApi:!0,verticalScrollClass:"vertical-scroll",tableClass:["col-md-12"],columnSettings:!1,apiSettings:{response:{success:Boolean,body:Array,recordsTotal:Number},request:"GET",url:this.urlHandler.url.inventory.get_stocks},columns:[{sorting:!0,field:"product",title:xt.text_product,filter:!0,type:"string",cssClass:"no",valueFunc:function(t){if(t)return t.name}},{sorting:!0,field:"quantity",title:xt.text_stock,filter:!0,type:"number",cssClass:"no",valueFunc:function(t,e){return t-e.soldQuantity}},{sorting:!0,field:"soldQuantity",title:xt.text_soldQuantity,filter:!0,type:"string",cssClass:"no"},{sorting:!0,field:"barcode",title:xt.text_barcode,filter:!0,type:"string",cssClass:"no"},{sorting:!0,field:"itemCode",title:xt.text_itemCode,filter:!0,type:"string",cssClass:"no"},{sorting:!0,field:"purchasePrice",title:xt.text_purchasePrice,filter:!0,type:"number",cssClass:"no"},{sorting:!0,field:"retailPrice",title:xt.text_retailPrice,filter:!0,type:"number",cssClass:"no"},{sorting:!0,field:"commisionAmount",title:"Commission",filter:!0,type:"number",cssClass:"no"}]},this.inventories=[],this.allRecords=[],this.isOnline=!0,this.data=[],this.columns={},this.importItems=[],this.list=[],this.selectedStock=new a,this.isOnline=!!navigator.onLine,this.user=this.authGuard.getLoggedInUser()}return t.prototype.ngOnInit=function(){return(0,s.mG)(this,void 0,void 0,function(){var t,e=this;return(0,s.Jh)(this,function(n){switch(n.label){case 0:return this.isOnline?(this.getData(),[3,3]):[3,1];case 1:return this.config.enablePagingWithApi=!1,t=this,[4,this.dbService.getAll("stock").toPromise()];case 2:t.data=n.sent(),this.totalAmount={purchase:0,retail:0},this.data.forEach(function(t){e.totalAmount.purchase+=(t.quantity-t.soldQuantity)*t.purchasePrice,e.totalAmount.retail+=(t.quantity-t.soldQuantity)*t.retailPrice}),n.label=3;case 3:return[2]}})})},t.prototype.getData=function(){return(0,s.mG)(this,void 0,void 0,function(){var t;return(0,s.Jh)(this,function(e){switch(e.label){case 0:return[4,this.apiService.get(""+this.urlHandler.url.inventory.get_total_stock_price)];case 1:return t=e.sent(),this.totalAmount=t.body,[2]}})})},t.prototype.openBrowseDialog=function(){document.getElementById("fileExcel").click()},t.prototype.incomingfile=function(t){this.file=t.target.files[0],this.importExcel()},t.prototype.importExcel=function(){var t=this,e=new FileReader;e.onload=function(n){t.arrayBuffer=e.result;for(var i=new Uint8Array(t.arrayBuffer),o=new Array,r=0;r!=i.length;++r)o[r]=String.fromCharCode(i[r]);var l=o.join(""),s=gt.ij(l,{type:"binary"});t.importItems=gt.P6.sheet_to_json(s.Sheets[s.SheetNames[0]],{raw:!1}),console.log(t.importItems[0]),t.columns=t.importItems[0],t.importItems.splice(0,1),console.log(t.importItems)},e.readAsArrayBuffer(this.file)},t.prototype.getKeyByValue=function(t){var e=this;return Object.keys(this.columns).find(function(n){return e.columns[n]===t})},t.prototype.upload=function(t){return void 0===t&&(t=!1),(0,s.mG)(this,void 0,void 0,function(){var e,n,i,o,r,l;return(0,s.Jh)(this,function(a){switch(a.label){case 0:for(this.loading=!0,this.list=[],n=0;n<this.importItems.length;n++)i=this.importItems[n],1==Object.keys(i).length&&(e=i.__EMPTY),i[this.getKeyByValue("product").toString()]&&((o={name:null,category:null,purchasePrice:0,retailPrice:0,barcode:null,quantity:0}).name=i[this.getKeyByValue("product").toString()],o.category=e,o.purchasePrice=parseFloat(i[this.getKeyByValue("purchasePrice").toString()].replace(",","")),o.retailPrice=parseFloat(i[this.getKeyByValue("retailPrice").toString()].replace(",","")),o.barcode=i[this.getKeyByValue("barcode").toString()],o.quantity=0==parseFloat(i[this.getKeyByValue("quantity").toString()])||parseFloat(i[this.getKeyByValue("quantity").toString()])<0?0:parseFloat(i[this.getKeyByValue("quantity").toString()].replace(",","")),this.list.push(o));console.log(this.list),this.index=0,this.chunk=100,a.label=1;case 1:return r=this.list.slice(this.index,this.index+this.chunk),[4,this.apiService.post(t?this.urlHandler.url.inventory.update_stock_price:this.urlHandler.url.inventory.import_stock,{products:r})];case 2:return l=a.sent(),console.log(l),!t&&l.success&&(this.inventories.concat(l.body),this.inventories=(0,s.ev)([],(0,s.CR)(this.inventories))),this.index+=this.chunk,this.index>this.list.length&&(this.index=this.list.length),this.index<this.list.length?[3,1]:[3,3];case 3:return this.loading=!1,[2]}})})},t.prototype.filterOutofStock=function(){this.inventories=this.showOutOfStock?this.allRecords.filter(function(t){return 0==t.quantity}):this.allRecords,this.inventories=(0,s.ev)([],(0,s.CR)(this.inventories))},t.prototype.savePackage=function(t){},t.prototype.openPackagePricePopup=function(){this.modalService.open(this.modalContent,{ariaLabelledBy:"modal-basic-title"}).result.then(function(t){console.log("Closed with")},function(t){console.log(t)})},t.prototype.clearLocalStock=function(){return(0,s.mG)(this,void 0,void 0,function(){return(0,s.Jh)(this,function(t){switch(t.label){case 0:return[4,this.dbService.clear("stock").toPromise()];case 1:return t.sent(),this.utilCtrl.showToast("Operation successful",this.utilCtrl.toastTypeArr.SUCCESS),[2]}})})},t.prototype.onRowClick=function(t){this.selectedRow=t.selectedRow,this.selectedRow&&(this.packageModel=t.selectedRow.package||{barcode:(new Date).getTime()}),t.refreshCall(!0)},t.prototype.addPackage=function(){return(0,s.mG)(this,void 0,void 0,function(){var t;return(0,s.Jh)(this,function(e){switch(e.label){case 0:return[4,this.apiService.post(this.urlHandler.url.inventory.add_package,{package:this.packageModel,id:this.selectedRow._id})];case 1:return t=e.sent(),console.log(t),t.success?(this.utilCtrl.showToast(xt[t.message],this.utilCtrl.toastTypeArr.SUCCESS),this.modalService.dismissAll()):this.utilCtrl.showToast(xt[t.message],this.utilCtrl.toastTypeArr.DANGER),[2]}})})},t.prototype.onColumnSettingsChange=function(t){console.log(t)},t.prototype.edit=function(t){this.showPopup=!0,this.selectedStock=t.data},t.prototype.onAddPopupClose=function(t){this.showPopup=!1,this.selectedStock=new a},t.\u0275fac=function(e){return new(e||t)(m.Y36(v.s),m.Y36(Z.z),m.Y36(f.a),m.Y36(ht.t2),m.Y36(mt.ys),m.Y36(ot.FF),m.Y36(U.b))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-stock"]],viewQuery:function(t,e){var n;1&t&&m.Gf(wt,7),2&t&&m.iGM(n=m.CRH())&&(e.modalContent=n.first)},decls:52,vars:24,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header"],[1,"row"],[1,"col-xl-3","col-md-3"],[1,"card","o-hidden","widget-cards","mb-0"],[1,"bg-primary","card-body","p-2","text-center"],[1,"media","static-top-widget","row"],[1,"media-body"],[1,"m-0"],[1,"mb-0"],[1,"counter"],[1,"col-xl-6","col-md-6"],[1,"col"],["for","chk-ani",1,"d-block"],["id","showOutOfStock","name","showOutOfStock","id","chk-ani","type","checkbox",1,"checkbox_animated",2,"width","auto !important",3,"ngModel","change","ngModelChange"],["hidden","","id","fileExcel","type","file","placeholder","Upload file","accept",".xlsx",2,"display","inline-block",3,"change"],[1,"btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-picture-o"],["type","button",1,"btn-sm","ml-2",3,"disabled","click"],["type","button",1,"ml-2","btn-sm",3,"click"],["type","button",1,"ml-2","btn-sm",3,"disabled","click"],[1,"card-body","vendor-table","pt-0"],["id","batchDelete",1,"custom-datatable","vendor-list"],[1,"table-responsive"],[3,"dataSource","config","onEditClick","onRowClick","onColumnSettingsChange"],[3,"model","showPopup","onPopupClose"],["modalContent",""],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title","f-w-600"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["novalidate","",1,"needs-validation","user-add"],["f","ngForm"],[1,"modal-body"],[1,"form-row"],[1,"form-group","col-md-12"],["type","text","name","barcode",1,"form-control",3,"ngModel","ngModelChange"],["barcode","ngModel"],["type","number","required","","name","quantity",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["quantity","ngModel"],[1,"invalid-feedback"],["for","price"],["id","price","name","price","type","number","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["price","ngModel"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-light",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"div",4),m.TgZ(5,"div",5),m.TgZ(6,"div",6),m.TgZ(7,"div",7),m.TgZ(8,"div",8),m.TgZ(9,"span",9),m._uU(10),m.ALo(11,"i18n"),m.qZA(),m.TgZ(12,"h3",10),m.TgZ(13,"span",11),m._uU(14),m.ALo(15,"round"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(16,"div",4),m.TgZ(17,"div",5),m.TgZ(18,"div",6),m.TgZ(19,"div",7),m.TgZ(20,"div",8),m.TgZ(21,"span",9),m._uU(22),m.ALo(23,"i18n"),m.qZA(),m.TgZ(24,"h3",10),m.TgZ(25,"span",11),m._uU(26),m.ALo(27,"round"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(28,"div",12),m.TgZ(29,"div",13),m.TgZ(30,"label",14),m.TgZ(31,"input",15),m.NdJ("change",function(){return e.filterOutofStock()})("ngModelChange",function(t){return e.showOutOfStock=t}),m.qZA(),m._uU(32," Show out of stock "),m.qZA(),m.qZA(),m.TgZ(33,"input",16),m.NdJ("change",function(t){return e.incomingfile(t)}),m.qZA(),m.TgZ(34,"button",17),m.NdJ("click",function(){return e.openBrowseDialog()}),m._UZ(35,"i",18),m._uU(36," Import Excel "),m.qZA(),m.TgZ(37,"button",19),m.NdJ("click",function(){return e.upload()}),m._uU(38),m.qZA(),m.TgZ(39,"button",19),m.NdJ("click",function(){return e.upload(!0)}),m._uU(40),m.qZA(),m.TgZ(41,"button",20),m.NdJ("click",function(){return e.clearLocalStock()}),m._uU(42,"Clear local stock"),m.qZA(),m.TgZ(43,"button",21),m.NdJ("click",function(){return e.openPackagePricePopup()}),m._uU(44,"Package Price"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(45,"div",22),m.TgZ(46,"div",23),m.TgZ(47,"div",24),m.TgZ(48,"ng2-paging-table",25),m.NdJ("onEditClick",function(t){return e.edit(t)})("onRowClick",function(t){return e.onRowClick(t)})("onColumnSettingsChange",function(t){return e.onColumnSettingsChange(t)}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(49,"app-edit-stock",26),m.NdJ("onPopupClose",function(t){return e.onAddPopupClose(t)}),m.qZA(),m.YNc(50,qt,46,30,"ng-template",null,27,m.W1O)),2&t&&(m.xp6(10),m.hij("",m.lcZ(11,16,"text_purchasePrice")," "),m.xp6(4),m.Oqu((null==e.user||null==e.user.company||null==e.user.company.country?null:e.user.company.country.currency.symbol)+" "+m.lcZ(15,18,null==e.totalAmount?null:e.totalAmount.purchase)),m.xp6(8),m.hij("",m.lcZ(23,20,"text_retailPrice")," "),m.xp6(4),m.Oqu((null==e.user||null==e.user.company||null==e.user.company.country?null:e.user.company.country.currency.symbol)+" "+m.lcZ(27,22,null==e.totalAmount?null:e.totalAmount.retail)),m.xp6(5),m.Q6J("ngModel",e.showOutOfStock),m.xp6(6),m.Q6J("disabled",e.loading||!e.importItems.length),m.xp6(1),m.AsE("Save Imports (",e.index,"/",e.list.length,")"),m.xp6(1),m.Q6J("disabled",e.loading||!e.importItems.length),m.xp6(1),m.AsE("Update Price (",e.index,"/",e.list.length,")"),m.xp6(3),m.Q6J("disabled",!e.selectedRow),m.xp6(5),m.Q6J("dataSource",e.data)("config",e.config),m.xp6(1),m.Q6J("model",e.selectedStock)("showPopup",e.showPopup))},directives:[b.Wl,b.JJ,b.On,ft.U,At,b._Y,b.JL,b.F,b.Fj,b.wV,b.Q7,i.mk],pipes:[A.X,K.L],styles:[""]}),t}(),Pt=function(t){return{"is-invalid":t}},_t=JSON.parse(localStorage.getItem("lang")),Mt=[{canActivate:[r.e],path:"",component:it,data:{title:"text_inventory",breadcrumb:"text_inventory",id:l.AN.CreateInventory}},{canActivate:[r.e],path:"edit/:id",component:it,data:{title:"text_inventory",breadcrumb:"text_inventory",id:l.AN.CreateInventory}},{canActivate:[r.e],path:"list",component:pt,data:{title:"text_items",breadcrumb:"text_items",id:l.AN.CreateInventory}},{canActivate:[r.e],path:"bills",component:function(){function t(t,e,n,i,o,r,l,s,a){var c=this;this.apiService=t,this.events=e,this.urlHandler=n,this.utilCtrl=i,this.socket=o,this.datePipe=r,this.parserFormatter=l,this.authGuard=s,this.router=a,this.apiURL=g.N.apiUrl,this.settings={actions:{position:"right",add:!1,edit:!0,delete:!1},mode:"external",delete:{confirmDelete:!1},columns:{billNo:{title:"Bill#",type:"string"},billId:{title:"Id",type:"string"},supplier:{title:"Supplier",type:"html",valuePrepareFunction:function(t,e){if(t)return t.name}},totalPurchasePrice:{title:"Total Purchase Price",type:"html",valuePrepareFunction:function(t,e){return c.user.company.country.currency.symbol+" "+t}},totalRetailPrice:{title:"Total Retail Price",type:"html",valuePrepareFunction:function(t,e){return c.user.company.country.currency.symbol+" "+t}},createdDate:{title:_t.text_date,type:"string",valuePrepareFunction:function(t,e){if(t)return c.datePipe.transform(t,"MMM d, y")}}}},this.billsList=[],this.totalAmount=0,this.user=new d.n,this.user=this.authGuard.getLoggedInUser();var u=new Date,p={day:u.getDate(),month:u.getMonth()+1,year:u.getFullYear()};this.startDate=p,this.endDate={day:u.getDate(),month:u.getMonth()+1,year:u.getFullYear()},this.socketEvents()}return t.prototype.socketEvents=function(){var t=this;this.socket.on("inventory_bill_created",function(e){t.billsList.unshift(e),t.billsList=(0,s.ev)([],(0,s.CR)(t.billsList)),t.totalAmount=t.totalAmount+e.amount}),this.socket.on("inventory_bill_deleted",function(e){var n=t.billsList.findIndex(function(t){return t._id==e._id});t.billsList.splice(n,1),t.billsList=(0,s.ev)([],(0,s.CR)(t.billsList))})},t.prototype.ngOnInit=function(){this.getData()},t.prototype.getData=function(){return(0,s.mG)(this,void 0,void 0,function(){var t,e,n;return(0,s.Jh)(this,function(i){switch(i.label){case 0:return t=this.parserFormatter.format(this.startDate),e=this.parserFormatter.format(this.endDate),[4,this.apiService.get(this.urlHandler.url.inventory.get_supplier_bills+"?startDate="+t+"&endDate="+e)];case 1:return n=i.sent(),this.billsList=n.body,console.log(n),[2]}})})},t.prototype.delete=function(t){this.showDeletePopup=!0,this.deleteURL=this.urlHandler.url.inventory.delete_supplier_bills+t.data._id},t.prototype.edit=function(t){this.router.navigate(["/inventory/edit/"+t.data._id])},t.\u0275fac=function(e){return new(e||t)(m.Y36(v.s),m.Y36(T.n),m.Y36(Z.z),m.Y36(U.b),m.Y36(N.sk),m.Y36(i.uU),m.Y36(ot.NG),m.Y36(f.a),m.Y36(o.F0))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-supplier-bills"]],decls:43,vars:27,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header"],[1,"row"],["novalidate","",1,"col-md-8","row",3,"ngSubmit"],["f","ngForm"],[1,"form-group","col-md-4"],[1,"col-xl-12","col-md-12","pl-0"],[1,"input-group"],["type","text","id","inputStartDate","name","inputStartDate","ngbDatepicker","","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["d1","ngbDatepicker","inputStartDate","ngModel"],[1,"input-group-append"],[1,"input-group-text",3,"click"],[1,"fa","fa-calendar",2,"cursor","pointer"],[1,"invalid-feedback"],["type","text","id","inputEndDate","name","inputEndDate","ngbDatepicker","","required","",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["d2","ngbDatepicker","inputEndDate","ngModel"],[1,"form-group","col-md-2"],["type","submit",1,"btn","btn-primary","mt-4"],[1,"card-body","vendor-table","pt-0"],["id","batchDelete",1,"custom-datatable","vendor-list"],[1,"table-responsive"],[3,"settings","source","edit","delete"],[3,"deleteURL","showPopup","onPopupClose"]],template:function(t,e){if(1&t){var n=m.EpF();m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.TgZ(3,"div",3),m.TgZ(4,"form",4,5),m.NdJ("ngSubmit",function(){return m.CHM(n),m.MAs(5).form.valid&&e.getData()}),m.TgZ(6,"div",6),m.TgZ(7,"label",7),m._uU(8),m.ALo(9,"i18n"),m.qZA(),m.TgZ(10,"div",8),m.TgZ(11,"input",9,10),m.NdJ("ngModelChange",function(t){return e.startDate=t}),m.qZA(),m.TgZ(14,"div",11),m.TgZ(15,"div",12),m.NdJ("click",function(){return m.CHM(n),m.MAs(12).toggle()}),m._UZ(16,"i",13),m.qZA(),m.qZA(),m.TgZ(17,"div",14),m._uU(18),m.ALo(19,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(20,"div",6),m.TgZ(21,"label",7),m._uU(22),m.ALo(23,"i18n"),m.qZA(),m.TgZ(24,"div",8),m.TgZ(25,"input",15,16),m.NdJ("ngModelChange",function(t){return e.endDate=t}),m.qZA(),m.TgZ(28,"div",11),m.TgZ(29,"div",12),m.NdJ("click",function(){return m.CHM(n),m.MAs(26).toggle()}),m._UZ(30,"i",13),m.qZA(),m.qZA(),m.TgZ(31,"div",14),m._uU(32),m.ALo(33,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(34,"div",17),m.TgZ(35,"button",18),m._uU(36),m.ALo(37,"i18n"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(38,"div",19),m.TgZ(39,"div",20),m.TgZ(40,"div",21),m.TgZ(41,"ng2-smart-table",22),m.NdJ("edit",function(t){return e.edit(t)})("delete",function(t){return e.delete(t)}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(42,"app-delete-record",23),m.NdJ("onPopupClose",function(){return e.showDeletePopup=!1}),m.qZA()}if(2&t){var i=m.MAs(5),o=m.MAs(13),r=m.MAs(27);m.xp6(8),m.Oqu(m.lcZ(9,13,"text_startDate")),m.xp6(3),m.Q6J("ngModel",e.startDate)("ngClass",m.VKq(23,Pt,i.submitted&&o.invalid)),m.xp6(7),m.hij(" ",m.lcZ(19,15,"text_startDate")," "),m.xp6(4),m.Oqu(m.lcZ(23,17,"text_endDate")),m.xp6(3),m.Q6J("ngModel",e.endDate)("ngClass",m.VKq(25,Pt,i.submitted&&r.invalid)),m.xp6(7),m.hij(" ",m.lcZ(33,19,"text_endDate")," "),m.xp6(4),m.Oqu(m.lcZ(37,21,"text_search")),m.xp6(5),m.Q6J("settings",e.settings)("source",e.billsList),m.xp6(1),m.Q6J("deleteURL",e.deleteURL)("showPopup",e.showDeletePopup)}},directives:[b._Y,b.JL,b.F,ot.J4,b.Fj,b.Q7,b.JJ,b.On,i.mk,h.T5,ut.c],pipes:[A.X],styles:[""]}),t}(),data:{title:"text_inventories",breadcrumb:"text_inventories",id:l.AN.CreateInventory}},{canActivate:[r.e],path:"stock",component:Ct,data:{title:"text_stock",breadcrumb:"text_stock",id:l.AN.CreateInventory}}],kt=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[o.Bz.forChild(Mt)],o.Bz]}),t}(),St=n(75425),Jt=n(99191),Nt=n(5653),Ut=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[i.ez,St.m,ot.IJ,b.u5,O.B,h.ne,b.UX,kt,Jt.n,y.K$,Nt.ProductsModule]]}),t}()}}]);